  [1m[35m (672.6ms)[0m  [1m[35mCREATE DATABASE "referral-api_development" ENCODING = 'unicode'[0m
  â†³ bin/rails:9
  [1m[35m (320.0ms)[0m  [1m[35mCREATE DATABASE "referral-api_test" ENCODING = 'unicode'[0m
  â†³ bin/rails:9
  [1m[35m (7.4ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  â†³ bin/rails:9
  [1m[35m (3.4ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL)[0m
  â†³ bin/rails:9
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_try_advisory_lock(952323785618856000)[0m
  â†³ bin/rails:9
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
Migrating to CreateUsers (20210131202438)
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (5.3ms)[0m  [1m[35mCREATE TABLE "users" ("id" bigserial primary key, "email" character varying, "password_digest" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL)[0m
  â†³ db/migrate/20210131202438_create_users.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.7ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210131202438"]]
  â†³ bin/rails:9
  [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
  â†³ bin/rails:9
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ bin/rails:9
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[36mActiveRecord::InternalMetadata Create (0.5ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2021-01-31 20:25:14.711204"], ["updated_at", "2021-01-31 20:25:14.711204"]]
  â†³ bin/rails:9
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(952323785618856000)[0m
  â†³ bin/rails:9
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
Started GET "/" for ::1 at 2021-01-31 23:25:59 +0300
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /Users/Alex/.rvm/gems/ruby-2.7.2/gems/activerecord-5.2.4.4/lib/active_record/log_subscriber.rb:98
Processing by Rails::WelcomeController#index as HTML
  Rendering /Users/Alex/.rvm/gems/ruby-2.7.2/gems/railties-5.2.4.4/lib/rails/templates/rails/welcome/index.html.erb
  Rendered /Users/Alex/.rvm/gems/ruby-2.7.2/gems/railties-5.2.4.4/lib/rails/templates/rails/welcome/index.html.erb (3.7ms)
Completed 200 OK in 12ms (Views: 10.3ms | ActiveRecord: 0.0ms)


Started GET "/favicon.ico" for ::1 at 2021-01-31 23:26:00 +0300
  
ActionController::RoutingError (No route matches [GET] "/favicon.ico"):
  
actionpack (5.2.4.4) lib/action_dispatch/middleware/debug_exceptions.rb:65:in `call'
actionpack (5.2.4.4) lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
railties (5.2.4.4) lib/rails/rack/logger.rb:38:in `call_app'
railties (5.2.4.4) lib/rails/rack/logger.rb:26:in `block in call'
activesupport (5.2.4.4) lib/active_support/tagged_logging.rb:71:in `block in tagged'
activesupport (5.2.4.4) lib/active_support/tagged_logging.rb:28:in `tagged'
activesupport (5.2.4.4) lib/active_support/tagged_logging.rb:71:in `tagged'
railties (5.2.4.4) lib/rails/rack/logger.rb:26:in `call'
actionpack (5.2.4.4) lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
actionpack (5.2.4.4) lib/action_dispatch/middleware/request_id.rb:27:in `call'
rack (2.2.3) lib/rack/runtime.rb:22:in `call'
activesupport (5.2.4.4) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (5.2.4.4) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (5.2.4.4) lib/action_dispatch/middleware/static.rb:127:in `call'
rack (2.2.3) lib/rack/sendfile.rb:110:in `call'
railties (5.2.4.4) lib/rails/engine.rb:524:in `call'
puma (3.12.6) lib/puma/configuration.rb:227:in `call'
puma (3.12.6) lib/puma/server.rb:706:in `handle_request'
puma (3.12.6) lib/puma/server.rb:476:in `process_client'
puma (3.12.6) lib/puma/server.rb:334:in `block in run'
puma (3.12.6) lib/puma/thread_pool.rb:135:in `block in spawn_thread'
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Create (1.8ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["email", "qwe@qwe.qwe"], ["password_digest", "$2a$12$HuxNTImRQOtvYjoy8GLy3enYgNO8u5vhkFKE650Yy08OL2Q8fSyQi"], ["created_at", "2021-02-01 09:06:26.248641"], ["updated_at", "2021-02-01 09:06:26.248641"]]
  [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
Started POST "/authenticate" for ::1 at 2021-02-01 12:07:18 +0300
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /Users/Alex/.rvm/gems/ruby-2.7.2/gems/activerecord-5.2.4.4/lib/active_record/log_subscriber.rb:98
Processing by AuthenticationController#authenticate as */*
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."email" IS NULL LIMIT $1[0m  [["LIMIT", 1]]
  â†³ app/services/authenticate_user.rb:22
Completed 500 Internal Server Error in 11ms (ActiveRecord: 2.7ms)


  
NoMethodError (undefined method `authenticate' for nil:NilClass):
  
app/services/authenticate_user.rb:16:in `authenticated_user'
app/services/authenticate_user.rb:8:in `call'
app/controllers/authentication_controller.rb:5:in `authenticate'
Started POST "/authenticate" for ::1 at 2021-02-01 12:08:23 +0300
Processing by AuthenticationController#authenticate as */*
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."email" IS NULL LIMIT $1[0m  [["LIMIT", 1]]
  â†³ app/services/authenticate_user.rb:22
Completed 500 Internal Server Error in 2ms (ActiveRecord: 0.3ms)


  
NoMethodError (undefined method `authenticate' for nil:NilClass):
  
app/services/authenticate_user.rb:16:in `authenticated_user'
app/services/authenticate_user.rb:8:in `call'
app/controllers/authentication_controller.rb:5:in `authenticate'
Started POST "/authenticate" for ::1 at 2021-02-01 12:08:59 +0300
Processing by AuthenticationController#authenticate as */*
  Parameters: {"{email: qwe@qwe.qwe, password: 123qwe123}"=>"[FILTERED]"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."email" IS NULL LIMIT $1[0m  [["LIMIT", 1]]
  â†³ app/services/authenticate_user.rb:22
Completed 500 Internal Server Error in 2ms (ActiveRecord: 0.3ms)


  
NoMethodError (undefined method `authenticate' for nil:NilClass):
  
app/services/authenticate_user.rb:16:in `authenticated_user'
app/services/authenticate_user.rb:8:in `call'
app/controllers/authentication_controller.rb:5:in `authenticate'
Started POST "/authenticate" for ::1 at 2021-02-01 12:09:24 +0300
Processing by AuthenticationController#authenticate as */*
  Parameters: {"{\"email\": \"qwe@qwe.qwe\", \"password\": \"123qwe123\"}"=>"[FILTERED]"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."email" IS NULL LIMIT $1[0m  [["LIMIT", 1]]
  â†³ app/services/authenticate_user.rb:22
Completed 500 Internal Server Error in 2ms (ActiveRecord: 0.3ms)


  
NoMethodError (undefined method `authenticate' for nil:NilClass):
  
app/services/authenticate_user.rb:16:in `authenticated_user'
app/services/authenticate_user.rb:8:in `call'
app/controllers/authentication_controller.rb:5:in `authenticate'
Started POST "/authenticate" for ::1 at 2021-02-01 12:09:48 +0300
Processing by AuthenticationController#authenticate as */*
  Parameters: {"{\"email\": \"qwe@qwe.qwe\", \"password\": \"123qwe123\"}"=>"[FILTERED]"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."email" IS NULL LIMIT $1[0m  [["LIMIT", 1]]
  â†³ app/services/authenticate_user.rb:24
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."email" IS NULL LIMIT $1[0m  [["LIMIT", 1]]
  â†³ app/services/authenticate_user.rb:24
Completed 500 Internal Server Error in 25710ms (ActiveRecord: 2.7ms)


  
NoMethodError (undefined method `authenticate' for nil:NilClass):
  
app/services/authenticate_user.rb:18:in `authenticated_user'
app/services/authenticate_user.rb:10:in `call'
app/controllers/authentication_controller.rb:5:in `authenticate'
Started POST "/authenticate" for ::1 at 2021-02-01 12:10:56 +0300
Processing by AuthenticationController#authenticate as */*
  Parameters: {"email"=>"example@mail.com", "password"=>"[FILTERED]", "authentication"=>{"email"=>"example@mail.com", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "example@mail.com"], ["LIMIT", 1]]
  â†³ app/services/authenticate_user.rb:24
Completed 500 Internal Server Error in 8926ms (ActiveRecord: 0.4ms)


  
NoMethodError (undefined method `authenticate' for nil:NilClass):
  
app/services/authenticate_user.rb:18:in `authenticated_user'
app/services/authenticate_user.rb:10:in `call'
app/controllers/authentication_controller.rb:5:in `authenticate'
Started POST "/authenticate" for ::1 at 2021-02-01 12:11:21 +0300
Processing by AuthenticationController#authenticate as */*
  Parameters: {"email"=>"qwe@qwe.qwe", "password"=>"[FILTERED]", "authentication"=>{"email"=>"qwe@qwe.qwe", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "qwe@qwe.qwe"], ["LIMIT", 1]]
  â†³ app/services/authenticate_user.rb:24
Completed 200 OK in 6267ms (Views: 0.2ms | ActiveRecord: 6.1ms)


Started POST "/sign_up" for ::1 at 2021-02-01 12:21:23 +0300
  [1m[35m (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /Users/Alex/.rvm/gems/ruby-2.7.2/gems/activerecord-5.2.4.4/lib/active_record/log_subscriber.rb:98
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"qwe@qwe.qwe", "password"=>"[FILTERED]", "registration"=>{"email"=>"qwe@qwe.qwe", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/controllers/registrations_controller.rb:5
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["email", "qwe@qwe.qwe"], ["password_digest", "$2a$12$ntbC4QFSLX46fYB8/Nt5UeBkn7m6r2wQQjzErJsWuDBSNt/Ph5ppS"], ["created_at", "2021-02-01 09:21:24.023097"], ["updated_at", "2021-02-01 09:21:24.023097"]]
  â†³ app/controllers/registrations_controller.rb:5
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/controllers/registrations_controller.rb:5
Unpermitted parameter: :registration
Completed 200 OK in 508ms (Views: 0.4ms | ActiveRecord: 8.1ms)


  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" ORDER BY "users"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" LIMIT $1[0m  [["LIMIT", 11]]
Started POST "/sign_up" for ::1 at 2021-02-01 12:24:34 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"qwe@qwe.qwe", "password"=>"[FILTERED]", "registration"=>{"email"=>"qwe@qwe.qwe", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/controllers/registrations_controller.rb:21
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "qwe@qwe.qwe"], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:21
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/controllers/registrations_controller.rb:21
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "qwe@qwe.qwe"], ["LIMIT", 1]]
  â†³ (byebug):1
Completed 200 OK in 15047ms (Views: 0.5ms | ActiveRecord: 6.9ms)


Started POST "/sign_up" for ::1 at 2021-02-01 12:25:03 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"qwe@qwe.qwe", "password"=>"[FILTERED]", "registration"=>{"email"=>"qwe@qwe.qwe", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/controllers/registrations_controller.rb:19
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "qwe@qwe.qwe"], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:19
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/controllers/registrations_controller.rb:19
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "qwe@qwe.qwe"], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:5
Completed 200 OK in 271ms (Views: 0.1ms | ActiveRecord: 7.6ms)


Started POST "/sign_up" for ::1 at 2021-02-01 12:25:15 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"qwe@qwe.qwe", "password"=>"[FILTERED]", "registration"=>{"email"=>"qwe@qwe.qwe", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/controllers/registrations_controller.rb:19
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "qwe@qwe.qwe"], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:19
  [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/controllers/registrations_controller.rb:19
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "qwe@qwe.qwe"], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:5
Completed 200 OK in 9ms (Views: 0.2ms | ActiveRecord: 1.9ms)


Started POST "/sign_up" for ::1 at 2021-02-01 12:25:26 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"qwe@qweq.qwe", "password"=>"[FILTERED]", "registration"=>{"email"=>"qwe@qweq.qwe", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/controllers/registrations_controller.rb:19
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "qwe@qweq.qwe"], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:19
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["email", "qwe@qweq.qwe"], ["password_digest", "$2a$12$v7Scc18Ab7pNTAEZxXNVlexSNWeHOg1KcmzSCMs5jDVKyLFXcLsPK"], ["created_at", "2021-02-01 09:25:26.729291"], ["updated_at", "2021-02-01 09:25:26.729291"]]
  â†³ app/controllers/registrations_controller.rb:19
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/controllers/registrations_controller.rb:19
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 AND "users"."id" != $2 LIMIT $3[0m  [["email", "qwe@qweq.qwe"], ["id", 3], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:5
Completed 200 OK in 263ms (Views: 0.3ms | ActiveRecord: 2.1ms)


Started POST "/authenticate" for ::1 at 2021-02-01 12:26:10 +0300
Processing by AuthenticationController#create as */*
  Parameters: {"email"=>"qwe@qwe.qwe", "password"=>"[FILTERED]", "authentication"=>{"email"=>"qwe@qwe.qwe", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "qwe@qwe.qwe"], ["LIMIT", 1]]
  â†³ app/services/authenticate_user.rb:24
Completed 500 Internal Server Error in 4275ms (ActiveRecord: 0.7ms)


  
RuntimeError (Invalid credentials):
  
app/services/authenticate_user.rb:20:in `authenticated_user'
app/services/authenticate_user.rb:10:in `call'
app/controllers/authentication_controller.rb:5:in `create'
Started POST "/authenticate" for ::1 at 2021-02-01 12:27:05 +0300
Processing by AuthenticationController#create as */*
  Parameters: {"email"=>"qwe@qwe.qwe", "password"=>"[FILTERED]", "authentication"=>{"email"=>"qwe@qwe.qwe", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "qwe@qwe.qwe"], ["LIMIT", 1]]
  â†³ app/services/authenticate_user.rb:22
Completed 500 Internal Server Error in 276ms (ActiveRecord: 6.2ms)


  
NameError (undefined local variable or method `errors' for #<AuthenticateUser:0x00007f911c52d2f8>):
  
app/services/authenticate_user.rb:18:in `authenticated_user'
app/services/authenticate_user.rb:8:in `call'
app/controllers/authentication_controller.rb:5:in `create'
Started POST "/authenticate" for ::1 at 2021-02-01 12:27:29 +0300
Processing by AuthenticationController#create as */*
  Parameters: {"email"=>"qwe@qwe.qwe", "password"=>"[FILTERED]", "authentication"=>{"email"=>"qwe@qwe.qwe", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "qwe@qwe.qwe"], ["LIMIT", 1]]
  â†³ app/services/authenticate_user.rb:22
Completed 500 Internal Server Error in 276ms (ActiveRecord: 6.4ms)


  
NoMethodError (undefined method `Invalid credentials' for #<User:0x00007f911ac05460>):
  
app/services/authenticate_user.rb:18:in `authenticated_user'
app/services/authenticate_user.rb:8:in `call'
app/controllers/authentication_controller.rb:5:in `create'
Started POST "/authenticate" for ::1 at 2021-02-02 11:56:58 +0300
  
PG::ConnectionBad (could not connect to server: No such file or directory
	Is the server running locally and accepting
	connections on Unix domain socket "/tmp/.s.PGSQL.5432"?
):
  
pg (1.2.3) lib/pg.rb:58:in `initialize'
pg (1.2.3) lib/pg.rb:58:in `new'
pg (1.2.3) lib/pg.rb:58:in `connect'
activerecord (5.2.4.4) lib/active_record/connection_adapters/postgresql_adapter.rb:692:in `connect'
activerecord (5.2.4.4) lib/active_record/connection_adapters/postgresql_adapter.rb:223:in `initialize'
activerecord (5.2.4.4) lib/active_record/connection_adapters/postgresql_adapter.rb:48:in `new'
activerecord (5.2.4.4) lib/active_record/connection_adapters/postgresql_adapter.rb:48:in `postgresql_connection'
activerecord (5.2.4.4) lib/active_record/connection_adapters/abstract/connection_pool.rb:830:in `new_connection'
activerecord (5.2.4.4) lib/active_record/connection_adapters/abstract/connection_pool.rb:874:in `checkout_new_connection'
activerecord (5.2.4.4) lib/active_record/connection_adapters/abstract/connection_pool.rb:853:in `try_to_checkout_new_connection'
activerecord (5.2.4.4) lib/active_record/connection_adapters/abstract/connection_pool.rb:814:in `acquire_connection'
activerecord (5.2.4.4) lib/active_record/connection_adapters/abstract/connection_pool.rb:538:in `checkout'
activerecord (5.2.4.4) lib/active_record/connection_adapters/abstract/connection_pool.rb:382:in `connection'
activerecord (5.2.4.4) lib/active_record/connection_adapters/abstract/connection_pool.rb:1033:in `retrieve_connection'
activerecord (5.2.4.4) lib/active_record/connection_handling.rb:118:in `retrieve_connection'
activerecord (5.2.4.4) lib/active_record/connection_handling.rb:90:in `connection'
activerecord (5.2.4.4) lib/active_record/migration.rb:554:in `call'
actionpack (5.2.4.4) lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'
activesupport (5.2.4.4) lib/active_support/callbacks.rb:98:in `run_callbacks'
actionpack (5.2.4.4) lib/action_dispatch/middleware/callbacks.rb:26:in `call'
actionpack (5.2.4.4) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (5.2.4.4) lib/action_dispatch/middleware/debug_exceptions.rb:61:in `call'
actionpack (5.2.4.4) lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
railties (5.2.4.4) lib/rails/rack/logger.rb:38:in `call_app'
railties (5.2.4.4) lib/rails/rack/logger.rb:26:in `block in call'
activesupport (5.2.4.4) lib/active_support/tagged_logging.rb:71:in `block in tagged'
activesupport (5.2.4.4) lib/active_support/tagged_logging.rb:28:in `tagged'
activesupport (5.2.4.4) lib/active_support/tagged_logging.rb:71:in `tagged'
railties (5.2.4.4) lib/rails/rack/logger.rb:26:in `call'
actionpack (5.2.4.4) lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
actionpack (5.2.4.4) lib/action_dispatch/middleware/request_id.rb:27:in `call'
rack (2.2.3) lib/rack/runtime.rb:22:in `call'
activesupport (5.2.4.4) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (5.2.4.4) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (5.2.4.4) lib/action_dispatch/middleware/static.rb:127:in `call'
rack (2.2.3) lib/rack/sendfile.rb:110:in `call'
railties (5.2.4.4) lib/rails/engine.rb:524:in `call'
puma (3.12.6) lib/puma/configuration.rb:227:in `call'
puma (3.12.6) lib/puma/server.rb:706:in `handle_request'
puma (3.12.6) lib/puma/server.rb:476:in `process_client'
puma (3.12.6) lib/puma/server.rb:334:in `block in run'
puma (3.12.6) lib/puma/thread_pool.rb:135:in `block in spawn_thread'
Started POST "/authenticate" for ::1 at 2021-02-02 11:57:06 +0300
  [1m[35m (2.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /Users/Alex/.rvm/gems/ruby-2.7.2/gems/activerecord-5.2.4.4/lib/active_record/log_subscriber.rb:98
Processing by AuthenticationController#create as */*
  Parameters: {"email"=>"qwe@qwe.qwe", "password"=>"[FILTERED]", "authentication"=>{"email"=>"qwe@qwe.qwe", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (2.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "qwe@qwe.qwe"], ["LIMIT", 1]]
  â†³ app/services/authenticate_user.rb:22
Completed 500 Internal Server Error in 286ms (ActiveRecord: 16.3ms)


  
NoMethodError (undefined method `Invalid credentials' for #<User:0x00007f962b22b730>):
  
app/services/authenticate_user.rb:18:in `authenticated_user'
app/services/authenticate_user.rb:8:in `call'
app/controllers/authentication_controller.rb:5:in `create'
Started POST "/authenticate" for ::1 at 2021-02-02 11:57:44 +0300
Processing by AuthenticationController#create as */*
  Parameters: {"email"=>"qwe@qwe.qwe", "password"=>"[FILTERED]", "authentication"=>{"email"=>"qwe@qwe.qwe", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "qwe@qwe.qwe"], ["LIMIT", 1]]
  â†³ app/services/authenticate_user.rb:22
Completed 500 Internal Server Error in 272ms (ActiveRecord: 6.8ms)


  
NoMethodError (undefined method `id' for "Invalid credentials":String):
  
app/services/authenticate_user.rb:8:in `call'
app/controllers/authentication_controller.rb:5:in `create'
Started POST "/authenticate" for ::1 at 2021-02-02 11:58:12 +0300
Processing by AuthenticationController#create as */*
  Parameters: {"email"=>"qwe@qwe.qwe", "password"=>"[FILTERED]", "authentication"=>{"email"=>"qwe@qwe.qwe", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "qwe@qwe.qwe"], ["LIMIT", 1]]
  â†³ app/services/authenticate_user.rb:22
Completed 500 Internal Server Error in 273ms (ActiveRecord: 6.7ms)


  
RuntimeError (Invalid credentials):
  
app/services/authenticate_user.rb:18:in `authenticated_user'
app/services/authenticate_user.rb:8:in `call'
app/controllers/authentication_controller.rb:5:in `create'
Started POST "/authenticate" for ::1 at 2021-02-02 11:58:21 +0300
Processing by AuthenticationController#create as */*
  Parameters: {"email"=>"qwe@qwe.qwe", "password"=>"[FILTERED]", "authentication"=>{"email"=>"qwe@qwe.qwe", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "qwe@qwe.qwe"], ["LIMIT", 1]]
  â†³ app/services/authenticate_user.rb:22
Completed 200 OK in 257ms (Views: 0.3ms | ActiveRecord: 0.3ms)


Started POST "/sign_up" for ::1 at 2021-02-02 11:58:36 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"qwe@qweq.qwe", "password"=>"[FILTERED]", "registration"=>{"email"=>"qwe@qweq.qwe", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/controllers/registrations_controller.rb:19
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "qwe@qweq.qwe"], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:19
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/controllers/registrations_controller.rb:19
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "qwe@qweq.qwe"], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:5
Completed 200 OK in 265ms (Views: 0.1ms | ActiveRecord: 1.1ms)


Started POST "/sign_up" for ::1 at 2021-02-02 11:58:43 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"qwe@qweq.qweq", "password"=>"[FILTERED]", "registration"=>{"email"=>"qwe@qweq.qweq", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/controllers/registrations_controller.rb:19
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "qwe@qweq.qweq"], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:19
  [1m[36mUser Create (4.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["email", "qwe@qweq.qweq"], ["password_digest", "$2a$12$cAhpLL.XgoIpLPWl7xmci.o5CSIoJI7qNet49NO6sq.0zMeBMVp86"], ["created_at", "2021-02-02 08:58:43.360021"], ["updated_at", "2021-02-02 08:58:43.360021"]]
  â†³ app/controllers/registrations_controller.rb:19
  [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/controllers/registrations_controller.rb:19
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 AND "users"."id" != $2 LIMIT $3[0m  [["email", "qwe@qweq.qweq"], ["id", 4], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:5
Completed 200 OK in 264ms (Views: 0.3ms | ActiveRecord: 5.6ms)


Started GET "/api/dialogflow/conversation_profiles/1" for ::1 at 2021-02-02 20:32:37 +0300
  
ActionController::RoutingError (No route matches [GET] "/api/dialogflow/conversation_profiles/1"):
  
actionpack (5.2.4.4) lib/action_dispatch/middleware/debug_exceptions.rb:65:in `call'
actionpack (5.2.4.4) lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
railties (5.2.4.4) lib/rails/rack/logger.rb:38:in `call_app'
railties (5.2.4.4) lib/rails/rack/logger.rb:26:in `block in call'
activesupport (5.2.4.4) lib/active_support/tagged_logging.rb:71:in `block in tagged'
activesupport (5.2.4.4) lib/active_support/tagged_logging.rb:28:in `tagged'
activesupport (5.2.4.4) lib/active_support/tagged_logging.rb:71:in `tagged'
railties (5.2.4.4) lib/rails/rack/logger.rb:26:in `call'
actionpack (5.2.4.4) lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
actionpack (5.2.4.4) lib/action_dispatch/middleware/request_id.rb:27:in `call'
rack (2.2.3) lib/rack/runtime.rb:22:in `call'
activesupport (5.2.4.4) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (5.2.4.4) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (5.2.4.4) lib/action_dispatch/middleware/static.rb:127:in `call'
rack (2.2.3) lib/rack/sendfile.rb:110:in `call'
railties (5.2.4.4) lib/rails/engine.rb:524:in `call'
puma (3.12.6) lib/puma/configuration.rb:227:in `call'
puma (3.12.6) lib/puma/server.rb:706:in `handle_request'
puma (3.12.6) lib/puma/server.rb:476:in `process_client'
puma (3.12.6) lib/puma/server.rb:334:in `block in run'
puma (3.12.6) lib/puma/thread_pool.rb:135:in `block in spawn_thread'
Started POST "/sign_up?referred_by=5" for ::1 at 2021-02-07 13:14:35 +0300
  
PG::ConnectionBad (could not connect to server: No such file or directory
	Is the server running locally and accepting
	connections on Unix domain socket "/tmp/.s.PGSQL.5432"?
):
  
pg (1.2.3) lib/pg.rb:58:in `initialize'
pg (1.2.3) lib/pg.rb:58:in `new'
pg (1.2.3) lib/pg.rb:58:in `connect'
activerecord (5.2.4.4) lib/active_record/connection_adapters/postgresql_adapter.rb:692:in `connect'
activerecord (5.2.4.4) lib/active_record/connection_adapters/postgresql_adapter.rb:223:in `initialize'
activerecord (5.2.4.4) lib/active_record/connection_adapters/postgresql_adapter.rb:48:in `new'
activerecord (5.2.4.4) lib/active_record/connection_adapters/postgresql_adapter.rb:48:in `postgresql_connection'
activerecord (5.2.4.4) lib/active_record/connection_adapters/abstract/connection_pool.rb:830:in `new_connection'
activerecord (5.2.4.4) lib/active_record/connection_adapters/abstract/connection_pool.rb:874:in `checkout_new_connection'
activerecord (5.2.4.4) lib/active_record/connection_adapters/abstract/connection_pool.rb:853:in `try_to_checkout_new_connection'
activerecord (5.2.4.4) lib/active_record/connection_adapters/abstract/connection_pool.rb:814:in `acquire_connection'
activerecord (5.2.4.4) lib/active_record/connection_adapters/abstract/connection_pool.rb:538:in `checkout'
activerecord (5.2.4.4) lib/active_record/connection_adapters/abstract/connection_pool.rb:382:in `connection'
activerecord (5.2.4.4) lib/active_record/connection_adapters/abstract/connection_pool.rb:1033:in `retrieve_connection'
activerecord (5.2.4.4) lib/active_record/connection_handling.rb:118:in `retrieve_connection'
activerecord (5.2.4.4) lib/active_record/connection_handling.rb:90:in `connection'
activerecord (5.2.4.4) lib/active_record/migration.rb:554:in `call'
actionpack (5.2.4.4) lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'
activesupport (5.2.4.4) lib/active_support/callbacks.rb:98:in `run_callbacks'
actionpack (5.2.4.4) lib/action_dispatch/middleware/callbacks.rb:26:in `call'
actionpack (5.2.4.4) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (5.2.4.4) lib/action_dispatch/middleware/debug_exceptions.rb:61:in `call'
actionpack (5.2.4.4) lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
railties (5.2.4.4) lib/rails/rack/logger.rb:38:in `call_app'
railties (5.2.4.4) lib/rails/rack/logger.rb:26:in `block in call'
activesupport (5.2.4.4) lib/active_support/tagged_logging.rb:71:in `block in tagged'
activesupport (5.2.4.4) lib/active_support/tagged_logging.rb:28:in `tagged'
activesupport (5.2.4.4) lib/active_support/tagged_logging.rb:71:in `tagged'
railties (5.2.4.4) lib/rails/rack/logger.rb:26:in `call'
actionpack (5.2.4.4) lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
actionpack (5.2.4.4) lib/action_dispatch/middleware/request_id.rb:27:in `call'
rack (2.2.3) lib/rack/runtime.rb:22:in `call'
activesupport (5.2.4.4) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (5.2.4.4) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (5.2.4.4) lib/action_dispatch/middleware/static.rb:127:in `call'
rack (2.2.3) lib/rack/sendfile.rb:110:in `call'
railties (5.2.4.4) lib/rails/engine.rb:524:in `call'
puma (3.12.6) lib/puma/configuration.rb:227:in `call'
puma (3.12.6) lib/puma/server.rb:706:in `handle_request'
puma (3.12.6) lib/puma/server.rb:476:in `process_client'
puma (3.12.6) lib/puma/server.rb:334:in `block in run'
puma (3.12.6) lib/puma/thread_pool.rb:135:in `block in spawn_thread'
Started POST "/sign_up?referred_by=5" for ::1 at 2021-02-07 13:14:46 +0300
  [1m[35m (3.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /Users/Alex/.rvm/gems/ruby-2.7.2/gems/activerecord-5.2.4.4/lib/active_record/log_subscriber.rb:98
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"qwe@qweq.qweq", "password"=>"[FILTERED]", "referred_by"=>"5", "registration"=>{"email"=>"qwe@qweq.qweq", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
Completed 500 Internal Server Error in 1ms (ActiveRecord: 0.0ms)


  
ArgumentError (wrong number of arguments (given 1, expected 0; required keyword: sign_up_params)):
  
app/services/users/creator.rb:3:in `initialize'
app/controllers/registrations_controller.rb:21:in `new'
app/controllers/registrations_controller.rb:21:in `user'
app/controllers/registrations_controller.rb:5:in `create'
Started POST "/sign_up?referred_by=5" for ::1 at 2021-02-07 13:15:15 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"qwe@qweq.qweq", "password"=>"[FILTERED]", "referred_by"=>"5", "registration"=>{"email"=>"qwe@qweq.qweq", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
Unpermitted parameter: :registration
Completed 500 Internal Server Error in 17888ms (ActiveRecord: 11.5ms)


  
ActiveModel::UnknownAttributeError (unknown attribute 'referred_by' for User.):
  
app/controllers/registrations_controller.rb:22:in `user'
app/controllers/registrations_controller.rb:5:in `create'
  [1m[36mUser Load (1.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" ORDER BY "users"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (1.3ms)[0m  [1m[34mSELECT pg_try_advisory_lock(952323785618856000)[0m
  â†³ bin/rails:9
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
Migrating to AddReferrerToUsers (20210207103024)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (5.5ms)[0m  [1m[35mALTER TABLE "users" ADD "referrer_id" bigint[0m
  â†³ db/migrate/20210207103024_add_referrer_to_users.rb:3
  [1m[35m (5.8ms)[0m  [1m[35mCREATE  INDEX  "index_users_on_referrer_id" ON "users"  ("referrer_id")[0m
  â†³ db/migrate/20210207103024_add_referrer_to_users.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (1.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210207103024"]]
  â†³ bin/rails:9
  [1m[35m (0.6ms)[0m  [1m[35mCOMMIT[0m
  â†³ bin/rails:9
  [1m[36mActiveRecord::InternalMetadata Load (1.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ bin/rails:9
  [1m[35m (0.4ms)[0m  [1m[34mSELECT pg_advisory_unlock(952323785618856000)[0m
  â†³ bin/rails:9
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" ORDER BY "users"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" ORDER BY "users"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" ORDER BY "users"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" ORDER BY "users"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(952323785618856000)[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
Migrating to AddReferrerToUsers (20210207103024)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (6.5ms)[0m  [1m[35mALTER TABLE "users" DROP COLUMN "referrer_id"[0m
  â†³ bin/rails:9
  [1m[36mActiveRecord::SchemaMigration Destroy (0.8ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = $1[0m  [["version", "20210207103024"]]
  â†³ bin/rails:9
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ bin/rails:9
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_advisory_unlock(952323785618856000)[0m
  â†³ bin/rails:9
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(952323785618856000)[0m
  â†³ bin/rails:9
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
Migrating to AddReferrerToUsers (20210207103024)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "users" ADD "referrer_id" bigint[0m
  â†³ db/migrate/20210207103024_add_referrer_to_users.rb:3
  [1m[35m (1.8ms)[0m  [1m[35mCREATE  INDEX  "index_users_on_referrer_id" ON "users"  ("referrer_id")[0m
  â†³ db/migrate/20210207103024_add_referrer_to_users.rb:3
  [1m[35m (2.3ms)[0m  [1m[35mALTER TABLE "users" ADD CONSTRAINT "fk_rails_92c9bd2db4"
FOREIGN KEY ("referrer_id")
  REFERENCES "referrers" ("id")
[0m
  â†³ db/migrate/20210207103024_add_referrer_to_users.rb:3
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  â†³ bin/rails:9
  [1m[35m (0.4ms)[0m  [1m[34mSELECT pg_advisory_unlock(952323785618856000)[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(952323785618856000)[0m
  â†³ bin/rails:9
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
Migrating to AddReferrerToUsers (20210207103024)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "users" ADD "referrer_id" bigint[0m
  â†³ db/migrate/20210207103024_add_referrer_to_users.rb:3
  [1m[35m (1.6ms)[0m  [1m[35mCREATE  INDEX  "index_users_on_referrer_id" ON "users"  ("referrer_id")[0m
  â†³ db/migrate/20210207103024_add_referrer_to_users.rb:3
  [1m[36mActiveRecord::SchemaMigration Create (0.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210207103024"]]
  â†³ bin/rails:9
  [1m[35m (0.6ms)[0m  [1m[35mCOMMIT[0m
  â†³ bin/rails:9
  [1m[36mActiveRecord::InternalMetadata Load (0.5ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ bin/rails:9
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ bin/rails:9
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_advisory_unlock(952323785618856000)[0m
  â†³ bin/rails:9
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" ORDER BY "users"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 AND "users"."id" != $2 LIMIT $3[0m  [["email", "qwe@qweq.qweq"], ["id", 4], ["LIMIT", 1]]
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" ORDER BY "users"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 AND "users"."id" != $2 LIMIT $3[0m  [["email", "qwe@qweq.qweq"], ["id", 4], ["LIMIT", 1]]
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" ORDER BY "users"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 AND "users"."id" != $2 LIMIT $3[0m  [["email", "qwe@qweq.qweq"], ["id", 4], ["LIMIT", 1]]
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Update (0.6ms)[0m  [1m[33mUPDATE "users" SET "referrer_id" = $1, "password_digest" = $2, "updated_at" = $3 WHERE "users"."id" = $4[0m  [["referrer_id", 1], ["password_digest", "$2a$12$x6VmngBtSWXwiySAUb4.VefJA/HMZoD0EQueQ0JfccZee1OZqLGKW"], ["updated_at", "2021-02-07 10:41:37.350981"], ["id", 4]]
  [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" ORDER BY "users"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" ORDER BY "users"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
Started POST "/sign_up?referrer_id=5" for ::1 at 2021-02-07 13:42:32 +0300
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /Users/Alex/.rvm/gems/ruby-2.7.2/gems/activerecord-5.2.4.4/lib/active_record/log_subscriber.rb:98
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"qwe@qweq.qweq", "password"=>"[FILTERED]", "referrer_id"=>"5", "registration"=>{"email"=>"qwe@qweq.qweq", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
Unpermitted parameter: :registration
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/controllers/registrations_controller.rb:22
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "qwe@qweq.qweq"], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:22
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:22
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/controllers/registrations_controller.rb:22
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "qwe@qweq.qweq"], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:5
Unpermitted parameter: :registration
Completed 200 OK in 20422ms (Views: 0.3ms | ActiveRecord: 8.6ms)


Started POST "/sign_up?referrer_id=5" for ::1 at 2021-02-07 13:43:07 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"qwe@qweq.qweq", "password"=>"[FILTERED]", "referrer_id"=>"5", "registration"=>{"email"=>"qwe@qweq.qweq", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
Unpermitted parameter: :registration
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/controllers/registrations_controller.rb:22
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "qwe@qweq.qweq"], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:22
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:22
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/controllers/registrations_controller.rb:22
Completed 422 Unprocessable Entity in 2869ms (ActiveRecord: 7.0ms)


  
ActiveRecord::RecordInvalid (Validation failed: Email has already been taken, Referrer must exist):
  
app/controllers/registrations_controller.rb:22:in `user'
app/controllers/registrations_controller.rb:5:in `create'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" ORDER BY "users"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Started POST "/sign_up?referrer_id=5" for ::1 at 2021-02-07 13:43:57 +0300
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /Users/Alex/.rvm/gems/ruby-2.7.2/gems/activerecord-5.2.4.4/lib/active_record/log_subscriber.rb:98
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"qwe@qweq.qweq", "password"=>"[FILTERED]", "referrer_id"=>"5", "registration"=>{"email"=>"qwe@qweq.qweq", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/controllers/registrations_controller.rb:22
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "qwe@qweq.qweq"], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:22
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/controllers/registrations_controller.rb:22
Completed 422 Unprocessable Entity in 1551ms (ActiveRecord: 7.9ms)


  
ActiveRecord::RecordInvalid (Validation failed: Email has already been taken):
  
app/controllers/registrations_controller.rb:22:in `user'
app/controllers/registrations_controller.rb:5:in `create'
Started POST "/sign_up?referrer_id=5" for ::1 at 2021-02-07 13:46:25 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"qwe@qweq.qweq", "password"=>"[FILTERED]", "referrer_id"=>"5", "registration"=>{"email"=>"qwe@qweq.qweq", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/controllers/registrations_controller.rb:22
  [1m[36mUser Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "qwe@qweq.qweq"], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:22
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/controllers/registrations_controller.rb:22
Completed 422 Unprocessable Entity in 2199ms (ActiveRecord: 11.4ms)


  
ActiveRecord::RecordInvalid (Validation failed: Email has already been taken):
  
app/controllers/registrations_controller.rb:22:in `user'
app/controllers/registrations_controller.rb:5:in `create'
Started POST "/sign_up?referrer_id=5" for ::1 at 2021-02-07 13:46:40 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"qwe", "password"=>"[FILTERED]", "referrer_id"=>"5", "registration"=>{"email"=>"qwe", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ app/controllers/registrations_controller.rb:22
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "qwe"], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:22
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/controllers/registrations_controller.rb:22
Completed 422 Unprocessable Entity in 1714ms (ActiveRecord: 1.0ms)


  
ActiveRecord::RecordInvalid (Validation failed: Email is invalid):
  
app/controllers/registrations_controller.rb:22:in `user'
app/controllers/registrations_controller.rb:5:in `create'
Started POST "/sign_up?referrer_id=5" for ::1 at 2021-02-07 13:46:55 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"test1@qwe.qwe", "password"=>"[FILTERED]", "referrer_id"=>"5", "registration"=>{"email"=>"test1@qwe.qwe", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/controllers/registrations_controller.rb:22
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "test1@qwe.qwe"], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:22
  [1m[36mUser Create (2.9ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at", "referrer_id") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["email", "test1@qwe.qwe"], ["password_digest", "$2a$12$G9eTvNFdnCT9WVEN8Y.WTe37g.me5Ybm9iLo8slbepKXU4vvxDo6y"], ["created_at", "2021-02-07 10:46:57.159051"], ["updated_at", "2021-02-07 10:46:57.159051"], ["referrer_id", 5]]
  â†³ app/controllers/registrations_controller.rb:22
  [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/controllers/registrations_controller.rb:22
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "test1@qwe.qwe"], ["id", 5], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:5
Completed 500 Internal Server Error in 15333ms (ActiveRecord: 4.4ms)


  
NameError (uninitialized constant RegistrationsController::Credits):
  
app/controllers/registrations_controller.rb:26:in `process_credits'
app/controllers/registrations_controller.rb:6:in `create'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" ORDER BY "users"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" ORDER BY "users"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
Started POST "/sign_up?referrer_id=7" for ::1 at 2021-02-07 13:47:57 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"test1@qwe.qwe", "password"=>"[FILTERED]", "referrer_id"=>"7", "registration"=>{"email"=>"test1@qwe.qwe", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/controllers/registrations_controller.rb:22
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "test1@qwe.qwe"], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:22
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/controllers/registrations_controller.rb:22
Completed 422 Unprocessable Entity in 1407ms (ActiveRecord: 6.2ms)


  
ActiveRecord::RecordInvalid (Validation failed: Email has already been taken):
  
app/controllers/registrations_controller.rb:22:in `user'
app/controllers/registrations_controller.rb:5:in `create'
Started POST "/sign_up?referrer_id=7" for ::1 at 2021-02-07 13:48:14 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"test1@qwe.qw", "password"=>"[FILTERED]", "referrer_id"=>"7", "registration"=>{"email"=>"test1@qwe.qw", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/controllers/registrations_controller.rb:22
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "test1@qwe.qw"], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:22
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at", "referrer_id") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["email", "test1@qwe.qw"], ["password_digest", "$2a$12$c0eiYVSfR7sbQwEZsnhJoebpngrihNWlnFvLFvBoD8rXhtIZ7PQWy"], ["created_at", "2021-02-07 10:48:16.215051"], ["updated_at", "2021-02-07 10:48:16.215051"], ["referrer_id", 7]]
  â†³ app/controllers/registrations_controller.rb:22
  [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/controllers/registrations_controller.rb:22
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "test1@qwe.qw"], ["id", 6], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:5
Completed 500 Internal Server Error in 4429ms (ActiveRecord: 2.3ms)


  
NameError (uninitialized constant RegistrationsController::Credits):
  
app/controllers/registrations_controller.rb:26:in `process_credits'
app/controllers/registrations_controller.rb:6:in `create'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" ORDER BY "users"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(952323785618856000)[0m
  â†³ bin/rails:9
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
Migrating to AddReferralPointsAndCreditsToUsers (20210207105104)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (0.6ms)[0m  [1m[35mALTER TABLE "referral_points" ADD "users" integer DEFAULT 0[0m
  â†³ db/migrate/20210207105104_add_referral_points_and_credits_to_users.rb:3
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(952323785618856000)[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(952323785618856000)[0m
  â†³ bin/rails:9
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
Migrating to AddReferralPointsAndCreditsToUsers (20210207105104)
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (1.8ms)[0m  [1m[35mALTER TABLE "users" ADD "referral_points" integer DEFAULT 0[0m
  â†³ db/migrate/20210207105104_add_referral_points_and_credits_to_users.rb:3
  [1m[35m (0.5ms)[0m  [1m[35mALTER TABLE "users" ADD "credits" integer DEFAULT 0[0m
  â†³ db/migrate/20210207105104_add_referral_points_and_credits_to_users.rb:4
  [1m[36mActiveRecord::SchemaMigration Create (0.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210207105104"]]
  â†³ bin/rails:9
  [1m[35m (0.6ms)[0m  [1m[35mCOMMIT[0m
  â†³ bin/rails:9
  [1m[36mActiveRecord::InternalMetadata Load (0.5ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(952323785618856000)[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" ORDER BY "users"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" ORDER BY "users"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" ORDER BY "users"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" ORDER BY "users"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" ORDER BY "users"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "asd@zxc.z"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["email", "asd@zxc.z"], ["password_digest", "$2a$12$4Uom/pUk91myrtSDGfL2BO/KR0HU7E67uFh.t3vQDLUX8ylVi57me"], ["created_at", "2021-02-07 10:59:35.757160"], ["updated_at", "2021-02-07 10:59:35.757160"]]
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
Started POST "/sign_up?referrer_id=7" for ::1 at 2021-02-07 14:03:36 +0300
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /Users/Alex/.rvm/gems/ruby-2.7.2/gems/activerecord-5.2.4.4/lib/active_record/log_subscriber.rb:98
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"test1@qwe.qwe", "password"=>"[FILTERED]", "referrer_id"=>"7", "registration"=>{"email"=>"test1@qwe.qwe", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
Completed 500 Internal Server Error in 6ms (ActiveRecord: 0.0ms)


  
NameError (undefined local variable or method `sign_up_params' for #<Users::Creator:0x00007fb333ff2308>):
  
app/services/users/creator.rb:25:in `user'
app/services/users/creator.rb:8:in `create'
app/controllers/registrations_controller.rb:23:in `user'
app/controllers/registrations_controller.rb:5:in `create'
Started POST "/sign_up?referrer_id=7" for ::1 at 2021-02-07 14:04:54 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"test1@qwe.qwe", "password"=>"[FILTERED]", "referrer_id"=>"7", "registration"=>{"email"=>"test1@qwe.qwe", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "test1@qwe.qwe"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:25
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/services/users/creator.rb:25
Completed 422 Unprocessable Entity in 282ms (ActiveRecord: 12.8ms)


  
ActiveRecord::RecordInvalid (Validation failed: Email has already been taken):
  
app/services/users/creator.rb:25:in `user'
app/services/users/creator.rb:8:in `create'
app/controllers/registrations_controller.rb:23:in `user'
app/controllers/registrations_controller.rb:5:in `create'
Started POST "/sign_up?referrer_id=7" for ::1 at 2021-02-07 14:05:33 +0300
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /Users/Alex/.rvm/gems/ruby-2.7.2/gems/activerecord-5.2.4.4/lib/active_record/log_subscriber.rb:98
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"atest1@qwe.qwe", "password"=>"[FILTERED]", "referrer_id"=>"7", "registration"=>{"email"=>"atest1@qwe.qwe", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "atest1@qwe.qwe"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["email", "atest1@qwe.qwe"], ["password_digest", "$2a$12$hByHT6lCuO8eUUZA0AkNROJe.xaLZ/XmAo3bfJ9KPPzNIuEM1LmI6"], ["created_at", "2021-02-07 11:05:34.334032"], ["updated_at", "2021-02-07 11:05:34.334032"]]
  â†³ app/services/users/creator.rb:25
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE (7) LIMIT $1[0m  [["LIMIT", 1]]
  â†³ app/services/users/creator.rb:21
Completed 500 Internal Server Error in 280ms (ActiveRecord: 11.0ms)


  
ActiveRecord::StatementInvalid (PG::DatatypeMismatch: ERROR:  argument of WHERE must be type boolean, not type integer
LINE 1: SELECT  "users".* FROM "users" WHERE (7) LIMIT $1
                                              ^
: SELECT  "users".* FROM "users" WHERE (7) LIMIT $1):
  
app/services/users/creator.rb:21:in `referrer'
app/services/users/creator.rb:10:in `create'
app/controllers/registrations_controller.rb:23:in `user'
app/controllers/registrations_controller.rb:5:in `create'
Started POST "/sign_up?referrer_id=7" for ::1 at 2021-02-07 14:06:03 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"qatest1@qwe.qwe", "password"=>"[FILTERED]", "referrer_id"=>"7", "registration"=>{"email"=>"qatest1@qwe.qwe", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "qatest1@qwe.qwe"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["email", "qatest1@qwe.qwe"], ["password_digest", "$2a$12$rV8GOqtcTutachP2Q08VhOMlkqlSFI4Qtt6x8/FFlVC2P/DpBA/Gu"], ["created_at", "2021-02-07 11:06:03.624933"], ["updated_at", "2021-02-07 11:06:03.624933"]]
  â†³ app/services/users/creator.rb:25
  [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:21
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "qatest1@qwe.qwe"], ["id", 9], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = $1, "referrer_id" = $2 WHERE "users"."id" = $3[0m  [["updated_at", "2021-02-07 11:06:03.633749"], ["referrer_id", 7], ["id", 9]]
  â†³ app/services/users/creator.rb:10
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "qatest1@qwe.qwe"], ["id", 9], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:7
Completed 200 OK in 289ms (Views: 0.4ms | ActiveRecord: 9.7ms)


Started POST "/sign_up?referrer_id=15" for ::1 at 2021-02-07 14:06:22 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"qatest1@qwe.qwee", "password"=>"[FILTERED]", "referrer_id"=>"15", "registration"=>{"email"=>"qatest1@qwe.qwee", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "qatest1@qwe.qwee"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["email", "qatest1@qwe.qwee"], ["password_digest", "$2a$12$oJUY4A.B5jBeRjTZwo15YOTyrP8UfUJADCCBnj7FH89kDJQBcWTE2"], ["created_at", "2021-02-07 11:06:23.016763"], ["updated_at", "2021-02-07 11:06:23.016763"]]
  â†³ app/services/users/creator.rb:25
  [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:21
Completed 404 Not Found in 255ms (ActiveRecord: 2.3ms)


  
ActiveRecord::RecordNotFound (Couldn't find User with 'id'=15):
  
app/services/users/creator.rb:21:in `referrer'
app/services/users/creator.rb:10:in `create'
app/controllers/registrations_controller.rb:23:in `user'
app/controllers/registrations_controller.rb:5:in `create'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 123], ["LIMIT", 1]]
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 123], ["LIMIT", 1]]
Started POST "/sign_up?referrer_id=15" for ::1 at 2021-02-07 14:07:22 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"qatest1@qwe.qweew", "password"=>"[FILTERED]", "referrer_id"=>"15", "registration"=>{"email"=>"qatest1@qwe.qweew", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "qatest1@qwe.qweew"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["email", "qatest1@qwe.qweew"], ["password_digest", "$2a$12$drLWOAg6lVwJF0xNM9pld.t4JNQdeFKaC2925YcQZlSZVg6bhzuWi"], ["created_at", "2021-02-07 11:07:22.774384"], ["updated_at", "2021-02-07 11:07:22.774384"]]
  â†³ app/services/users/creator.rb:25
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:21
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:21
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "qatest1@qwe.qweew"], ["id", 11], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:7
Completed 200 OK in 272ms (Views: 0.4ms | ActiveRecord: 8.6ms)


  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" ORDER BY "users"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" ORDER BY "users"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
Started POST "/sign_up?referrer_id=5" for ::1 at 2021-02-07 14:39:08 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"qatest1@qwe.qweews", "password"=>"[FILTERED]", "referrer_id"=>"5", "registration"=>{"email"=>"qatest1@qwe.qweews", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "qatest1@qwe.qweews"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["email", "qatest1@qwe.qweews"], ["password_digest", "$2a$12$7nQqXQ8fvagTGP5T5rlvrOAm8M4m2wBVa.3.doJwo0Oz.ZzE/fK4W"], ["created_at", "2021-02-07 11:39:08.917726"], ["updated_at", "2021-02-07 11:39:08.917726"]]
  â†³ app/services/users/creator.rb:25
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:21
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "qatest1@qwe.qweews"], ["id", 12], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = $1, "referrer_id" = $2 WHERE "users"."id" = $3[0m  [["updated_at", "2021-02-07 11:39:08.924345"], ["referrer_id", 5], ["id", 12]]
  â†³ app/services/users/creator.rb:10
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "qatest1@qwe.qweews"], ["id", 12], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:7
  [1m[36mUser Update All (0.9ms)[0m  [1m[33mUPDATE "users" SET "credits" = COALESCE("credits", 0) + 10 WHERE "users"."id" = $1[0m  [["id", 12]]
  â†³ app/services/credits/processor.rb:28
  [1m[36mUser Update All (0.6ms)[0m  [1m[33mUPDATE "users" SET "referral_points" = COALESCE("referral_points", 0) + 1 WHERE "users"."id" = $1[0m  [["id", 5]]
  â†³ app/services/credits/processor.rb:40
Completed 200 OK in 281ms (Views: 0.4ms | ActiveRecord: 16.1ms)


Started POST "/sign_up?referrer_id=5" for ::1 at 2021-02-07 14:39:30 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"qatest1@qwe.qweews", "password"=>"[FILTERED]", "referrer_id"=>"5", "registration"=>{"email"=>"qatest1@qwe.qweews", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "qatest1@qwe.qweews"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:25
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/services/users/creator.rb:25
Completed 422 Unprocessable Entity in 256ms (ActiveRecord: 0.7ms)


  
ActiveRecord::RecordInvalid (Validation failed: Email has already been taken):
  
app/services/users/creator.rb:25:in `user'
app/services/users/creator.rb:8:in `create'
app/controllers/registrations_controller.rb:23:in `user'
app/controllers/registrations_controller.rb:5:in `create'
Started POST "/sign_up?referrer_id=5" for ::1 at 2021-02-07 14:41:22 +0300
Error occurred while parsing request parameters.
Contents:

{"email": openssl rand -hex 4 + "@qwe.qweews","password":"q"}
  
ActionDispatch::Http::Parameters::ParseError (783: unexpected token at '{"email": openssl rand -hex 4 + "@qwe.qweews","password":"q"}'):
  
actionpack (5.2.4.4) lib/action_dispatch/http/parameters.rb:117:in `rescue in parse_formatted_parameters'
actionpack (5.2.4.4) lib/action_dispatch/http/parameters.rb:111:in `parse_formatted_parameters'
actionpack (5.2.4.4) lib/action_dispatch/http/request.rb:381:in `block in POST'
rack (2.2.3) lib/rack/request.rb:69:in `fetch'
rack (2.2.3) lib/rack/request.rb:69:in `fetch_header'
actionpack (5.2.4.4) lib/action_dispatch/http/request.rb:380:in `POST'
actionpack (5.2.4.4) lib/action_dispatch/http/parameters.rb:55:in `parameters'
actionpack (5.2.4.4) lib/action_controller/metal/params_wrapper.rb:290:in `_wrapper_enabled?'
actionpack (5.2.4.4) lib/action_controller/metal/params_wrapper.rb:244:in `process_action'
activerecord (5.2.4.4) lib/active_record/railties/controller_runtime.rb:24:in `process_action'
actionpack (5.2.4.4) lib/abstract_controller/base.rb:134:in `process'
actionpack (5.2.4.4) lib/action_controller/metal.rb:191:in `dispatch'
actionpack (5.2.4.4) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (5.2.4.4) lib/action_dispatch/routing/route_set.rb:52:in `dispatch'
actionpack (5.2.4.4) lib/action_dispatch/routing/route_set.rb:34:in `serve'
actionpack (5.2.4.4) lib/action_dispatch/journey/router.rb:52:in `block in serve'
actionpack (5.2.4.4) lib/action_dispatch/journey/router.rb:35:in `each'
actionpack (5.2.4.4) lib/action_dispatch/journey/router.rb:35:in `serve'
actionpack (5.2.4.4) lib/action_dispatch/routing/route_set.rb:840:in `call'
rack (2.2.3) lib/rack/etag.rb:27:in `call'
rack (2.2.3) lib/rack/conditional_get.rb:40:in `call'
rack (2.2.3) lib/rack/head.rb:12:in `call'
activerecord (5.2.4.4) lib/active_record/migration.rb:559:in `call'
actionpack (5.2.4.4) lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'
activesupport (5.2.4.4) lib/active_support/callbacks.rb:98:in `run_callbacks'
actionpack (5.2.4.4) lib/action_dispatch/middleware/callbacks.rb:26:in `call'
actionpack (5.2.4.4) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (5.2.4.4) lib/action_dispatch/middleware/debug_exceptions.rb:61:in `call'
actionpack (5.2.4.4) lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
railties (5.2.4.4) lib/rails/rack/logger.rb:38:in `call_app'
railties (5.2.4.4) lib/rails/rack/logger.rb:26:in `block in call'
activesupport (5.2.4.4) lib/active_support/tagged_logging.rb:71:in `block in tagged'
activesupport (5.2.4.4) lib/active_support/tagged_logging.rb:28:in `tagged'
activesupport (5.2.4.4) lib/active_support/tagged_logging.rb:71:in `tagged'
railties (5.2.4.4) lib/rails/rack/logger.rb:26:in `call'
actionpack (5.2.4.4) lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
actionpack (5.2.4.4) lib/action_dispatch/middleware/request_id.rb:27:in `call'
rack (2.2.3) lib/rack/runtime.rb:22:in `call'
activesupport (5.2.4.4) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (5.2.4.4) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (5.2.4.4) lib/action_dispatch/middleware/static.rb:127:in `call'
rack (2.2.3) lib/rack/sendfile.rb:110:in `call'
railties (5.2.4.4) lib/rails/engine.rb:524:in `call'
puma (3.12.6) lib/puma/configuration.rb:227:in `call'
puma (3.12.6) lib/puma/server.rb:706:in `handle_request'
puma (3.12.6) lib/puma/server.rb:476:in `process_client'
puma (3.12.6) lib/puma/server.rb:334:in `block in run'
puma (3.12.6) lib/puma/thread_pool.rb:135:in `block in spawn_thread'
Started POST "/sign_up?referrer_id=5" for ::1 at 2021-02-07 14:42:08 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"qatest1@qwe.qweewsasd", "password"=>"[FILTERED]", "referrer_id"=>"5", "registration"=>{"email"=>"qatest1@qwe.qweewsasd", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "qatest1@qwe.qweewsasd"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["email", "qatest1@qwe.qweewsasd"], ["password_digest", "$2a$12$5Cj0d36v8MgHm3WHP98.F.V.wCUTSs6qPrkP0pPbdWNUWIsx2vega"], ["created_at", "2021-02-07 11:42:08.761719"], ["updated_at", "2021-02-07 11:42:08.761719"]]
  â†³ app/services/users/creator.rb:25
  [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:21
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "qatest1@qwe.qweewsasd"], ["id", 13], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = $1, "referrer_id" = $2 WHERE "users"."id" = $3[0m  [["updated_at", "2021-02-07 11:42:08.766868"], ["referrer_id", 5], ["id", 13]]
  â†³ app/services/users/creator.rb:10
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "qatest1@qwe.qweewsasd"], ["id", 13], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:7
  [1m[36mUser Update All (0.5ms)[0m  [1m[33mUPDATE "users" SET "credits" = COALESCE("credits", 0) + 10 WHERE "users"."id" = $1[0m  [["id", 13]]
  â†³ app/services/credits/processor.rb:28
  [1m[36mUser Update All (0.6ms)[0m  [1m[33mUPDATE "users" SET "referral_points" = COALESCE("referral_points", 0) + 1 WHERE "users"."id" = $1[0m  [["id", 5]]
  â†³ app/services/credits/processor.rb:40
Completed 200 OK in 262ms (Views: 0.3ms | ActiveRecord: 5.0ms)


Started POST "/sign_up?referrer_id=5" for ::1 at 2021-02-07 14:42:23 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"qatest1@qwe.qweewsasdsdf", "password"=>"[FILTERED]", "referrer_id"=>"5", "registration"=>{"email"=>"qatest1@qwe.qweewsasdsdf", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "qatest1@qwe.qweewsasdsdf"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["email", "qatest1@qwe.qweewsasdsdf"], ["password_digest", "$2a$12$f9JbGD/OmftyeH8KVWjy9O/F5QGqwe2F3MqrgziaWDFiDhBj7QWcC"], ["created_at", "2021-02-07 11:42:24.188912"], ["updated_at", "2021-02-07 11:42:24.188912"]]
  â†³ app/services/users/creator.rb:25
  [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:21
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "qatest1@qwe.qweewsasdsdf"], ["id", 14], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = $1, "referrer_id" = $2 WHERE "users"."id" = $3[0m  [["updated_at", "2021-02-07 11:42:24.194108"], ["referrer_id", 5], ["id", 14]]
  â†³ app/services/users/creator.rb:10
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "qatest1@qwe.qweewsasdsdf"], ["id", 14], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:7
  [1m[36mUser Update All (0.6ms)[0m  [1m[33mUPDATE "users" SET "credits" = COALESCE("credits", 0) + 10 WHERE "users"."id" = $1[0m  [["id", 14]]
  â†³ app/services/credits/processor.rb:28
  [1m[36mUser Update All (0.5ms)[0m  [1m[33mUPDATE "users" SET "referral_points" = COALESCE("referral_points", 0) + 1 WHERE "users"."id" = $1[0m  [["id", 5]]
  â†³ app/services/credits/processor.rb:40
Completed 200 OK in 266ms (Views: 0.3ms | ActiveRecord: 4.9ms)


Started POST "/sign_up?referrer_id=5" for ::1 at 2021-02-07 14:42:31 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"qatest1@qwe.qweewsassdfdsdf", "password"=>"[FILTERED]", "referrer_id"=>"5", "registration"=>{"email"=>"qatest1@qwe.qweewsassdfdsdf", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "qatest1@qwe.qweewsassdfdsdf"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["email", "qatest1@qwe.qweewsassdfdsdf"], ["password_digest", "$2a$12$Yf0u3TV/jFYEnVVuN8IkKOizCaRviKRbgO/XGiQ3caEp3.Qlf8DzG"], ["created_at", "2021-02-07 11:42:31.637984"], ["updated_at", "2021-02-07 11:42:31.637984"]]
  â†³ app/services/users/creator.rb:25
  [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:21
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "qatest1@qwe.qweewsassdfdsdf"], ["id", 15], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = $1, "referrer_id" = $2 WHERE "users"."id" = $3[0m  [["updated_at", "2021-02-07 11:42:31.642896"], ["referrer_id", 5], ["id", 15]]
  â†³ app/services/users/creator.rb:10
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "qatest1@qwe.qweewsassdfdsdf"], ["id", 15], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:7
  [1m[36mUser Update All (0.5ms)[0m  [1m[33mUPDATE "users" SET "credits" = COALESCE("credits", 0) + 10 WHERE "users"."id" = $1[0m  [["id", 15]]
  â†³ app/services/credits/processor.rb:28
  [1m[36mUser Update All (0.5ms)[0m  [1m[33mUPDATE "users" SET "referral_points" = COALESCE("referral_points", 0) + 1 WHERE "users"."id" = $1[0m  [["id", 5]]
  â†³ app/services/credits/processor.rb:40
Completed 200 OK in 261ms (Views: 0.3ms | ActiveRecord: 4.8ms)


Started POST "/sign_up?referrer_id=5" for ::1 at 2021-02-07 14:42:39 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"qatest1@qwe.qweewsassdfdasfsdf", "password"=>"[FILTERED]", "referrer_id"=>"5", "registration"=>{"email"=>"qatest1@qwe.qweewsassdfdasfsdf", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "qatest1@qwe.qweewsassdfdasfsdf"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["email", "qatest1@qwe.qweewsassdfdasfsdf"], ["password_digest", "$2a$12$CwRLANRR10LeCsjSbHCUs.30UJ1u.pwNgXXIUJqkbg2dYu7K4mu8S"], ["created_at", "2021-02-07 11:42:39.676803"], ["updated_at", "2021-02-07 11:42:39.676803"]]
  â†³ app/services/users/creator.rb:25
  [1m[35m (1.6ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:21
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "qatest1@qwe.qweewsassdfdasfsdf"], ["id", 16], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = $1, "referrer_id" = $2 WHERE "users"."id" = $3[0m  [["updated_at", "2021-02-07 11:42:39.682328"], ["referrer_id", 5], ["id", 16]]
  â†³ app/services/users/creator.rb:10
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "qatest1@qwe.qweewsassdfdasfsdf"], ["id", 16], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:7
  [1m[36mUser Update All (0.5ms)[0m  [1m[33mUPDATE "users" SET "credits" = COALESCE("credits", 0) + 10 WHERE "users"."id" = $1[0m  [["id", 16]]
  â†³ app/services/credits/processor.rb:28
  [1m[36mUser Update All (0.5ms)[0m  [1m[33mUPDATE "users" SET "referral_points" = COALESCE("referral_points", 0) + 1 WHERE "users"."id" = $1[0m  [["id", 5]]
  â†³ app/services/credits/processor.rb:40
  [1m[36mUser Update All (0.4ms)[0m  [1m[33mUPDATE "users" SET "credits" = COALESCE("credits", 0) + 10 WHERE "users"."id" = $1[0m  [["id", 5]]
  â†³ app/services/credits/processor.rb:47
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/credits/processor.rb:48
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "test1@qwe.qwe"], ["id", 5], ["LIMIT", 1]]
  â†³ app/services/credits/processor.rb:48
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/services/credits/processor.rb:48
Completed 422 Unprocessable Entity in 266ms (ActiveRecord: 6.5ms)


  
ActiveRecord::RecordInvalid (Validation failed: Password can't be blank):
  
app/services/credits/processor.rb:48:in `process_referrer'
app/services/credits/processor.rb:12:in `run'
app/controllers/registrations_controller.rb:8:in `create'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" ORDER BY "users"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" ORDER BY "users"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" ORDER BY "users"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" ORDER BY "users"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" ORDER BY "users"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ bin/rails:9
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  â†³ bin/rails:9
  [1m[35m (151.3ms)[0m  [1m[35mDROP DATABASE IF EXISTS "referral-api_development"[0m
  â†³ bin/rails:9
  [1m[35m (170.9ms)[0m  [1m[35mDROP DATABASE IF EXISTS "referral-api_test"[0m
  â†³ bin/rails:9
  [1m[35m (405.6ms)[0m  [1m[35mCREATE DATABASE "referral-api_development" ENCODING = 'unicode'[0m
  â†³ bin/rails:9
  [1m[35m (291.4ms)[0m  [1m[35mCREATE DATABASE "referral-api_test" ENCODING = 'unicode'[0m
  â†³ bin/rails:9
  [1m[35mSQL (1.6ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "users" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (22.7ms)[0m  [1m[35mCREATE TABLE "users" ("id" bigserial primary key, "email" character varying, "password_digest" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL, "referrer_id" bigint, "referral_points" integer DEFAULT 0, "credits" integer DEFAULT 0)[0m
  â†³ db/schema.rb:18
  [1m[35m (2.0ms)[0m  [1m[35mCREATE  INDEX  "index_users_on_referrer_id" ON "users"  ("referrer_id")[0m
  â†³ db/schema.rb:18
  [1m[35m (5.5ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  â†³ db/schema.rb:13
  [1m[35m (2.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[35m (3.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20210207105104)[0m
  â†³ db/schema.rb:13
  [1m[35m (0.7ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20210131202438),
(20210207103024);

[0m
  â†³ db/schema.rb:13
  [1m[35m (7.7ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL)[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Create (0.8ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2021-02-07 11:45:28.375784"], ["updated_at", "2021-02-07 11:45:28.375784"]]
  â†³ db/schema.rb:13
  [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ bin/rails:9
  [1m[35mSQL (0.5ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  â†³ db/schema.rb:16
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "users" CASCADE[0m
  â†³ db/schema.rb:18
  [1m[35m (13.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" bigserial primary key, "email" character varying, "password_digest" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL, "referrer_id" bigint, "referral_points" integer DEFAULT 0, "credits" integer DEFAULT 0)[0m
  â†³ db/schema.rb:18
  [1m[35m (2.7ms)[0m  [1m[35mCREATE  INDEX  "index_users_on_referrer_id" ON "users"  ("referrer_id")[0m
  â†³ db/schema.rb:18
  [1m[35m (3.3ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  â†³ db/schema.rb:13
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ db/schema.rb:13
  [1m[35m (1.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20210207105104)[0m
  â†³ db/schema.rb:13
  [1m[35m (0.7ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20210131202438),
(20210207103024);

[0m
  â†³ db/schema.rb:13
  [1m[35m (4.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL)[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (1.0ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ db/schema.rb:13
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Create (1.4ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2021-02-07 11:45:28.467809"], ["updated_at", "2021-02-07 11:45:28.467809"]]
  â†³ db/schema.rb:13
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ db/schema.rb:13
  [1m[36mActiveRecord::InternalMetadata Load (0.5ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ bin/rails:9
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[36mActiveRecord::InternalMetadata Update (0.9ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = $1, "updated_at" = $2 WHERE "ar_internal_metadata"."key" = $3[0m  [["value", "test"], ["updated_at", "2021-02-07 11:45:28.475832"], ["key", "environment"]]
  â†³ bin/rails:9
  [1m[35m (0.6ms)[0m  [1m[35mCOMMIT[0m
  â†³ bin/rails:9
  [1m[35m (1.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
Started POST "/sign_up?referrer_id=5" for ::1 at 2021-02-07 14:45:36 +0300
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /Users/Alex/.rvm/gems/ruby-2.7.2/gems/activerecord-5.2.4.4/lib/active_record/log_subscriber.rb:98
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"qatest1@qwe.qweewsassdfdasfsdf", "password"=>"[FILTERED]", "referrer_id"=>"5", "registration"=>{"email"=>"qatest1@qwe.qweewsassdfdasfsdf", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Exists (3.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "qatest1@qwe.qweewsassdfdasfsdf"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Create (1.3ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["email", "qatest1@qwe.qweewsassdfdasfsdf"], ["password_digest", "$2a$12$Gg/cHxGsTwL0P.X30ojNpuJfxaHtkPMk2c7QnH1otjjRSPyKOYBf."], ["created_at", "2021-02-07 11:45:36.854071"], ["updated_at", "2021-02-07 11:45:36.854071"]]
  â†³ app/services/users/creator.rb:25
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:21
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:21
  [1m[36mUser Exists (1.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "qatest1@qwe.qweewsassdfdasfsdf"], ["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:7
Completed 200 OK in 317ms (Views: 0.6ms | ActiveRecord: 16.9ms)


  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" ORDER BY "users"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" ORDER BY "users"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
Started POST "/sign_up?referrer_id=1" for ::1 at 2021-02-07 14:46:12 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"qatest1@qwe.qweewsassdfdasfsd", "password"=>"[FILTERED]", "referrer_id"=>"1", "registration"=>{"email"=>"qatest1@qwe.qweewsassdfdasfsd", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "qatest1@qwe.qweewsassdfdasfsd"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["email", "qatest1@qwe.qweewsassdfdasfsd"], ["password_digest", "$2a$12$sLevsyALe9Vk9kRxlLmfBuhRd93vo8/6UL8rVt7EiMwdUIToRk0IO"], ["created_at", "2021-02-07 11:46:13.158127"], ["updated_at", "2021-02-07 11:46:13.158127"]]
  â†³ app/services/users/creator.rb:25
  [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:21
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "qatest1@qwe.qweewsassdfdasfsd"], ["id", 2], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = $1, "referrer_id" = $2 WHERE "users"."id" = $3[0m  [["updated_at", "2021-02-07 11:46:13.168497"], ["referrer_id", 1], ["id", 2]]
  â†³ app/services/users/creator.rb:10
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "qatest1@qwe.qweewsassdfdasfsd"], ["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:7
  [1m[36mUser Update All (0.8ms)[0m  [1m[33mUPDATE "users" SET "credits" = COALESCE("credits", 0) + 10 WHERE "users"."id" = $1[0m  [["id", 2]]
  â†³ app/services/credits/processor.rb:28
  [1m[36mUser Update All (0.6ms)[0m  [1m[33mUPDATE "users" SET "referral_points" = COALESCE("referral_points", 0) + 1 WHERE "users"."id" = $1[0m  [["id", 1]]
  â†³ app/services/credits/processor.rb:40
Completed 200 OK in 271ms (Views: 0.3ms | ActiveRecord: 5.3ms)


Started POST "/sign_up?referrer_id=1" for ::1 at 2021-02-07 14:46:21 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"qatest1@qwe.qweewsassdfdasfs", "password"=>"[FILTERED]", "referrer_id"=>"1", "registration"=>{"email"=>"qatest1@qwe.qweewsassdfdasfs", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "qatest1@qwe.qweewsassdfdasfs"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["email", "qatest1@qwe.qweewsassdfdasfs"], ["password_digest", "$2a$12$s1CGe/xwnT7twjngfFaMAukn3UmPbigsRbck9JvZx18sPQx8rsi4u"], ["created_at", "2021-02-07 11:46:22.031396"], ["updated_at", "2021-02-07 11:46:22.031396"]]
  â†³ app/services/users/creator.rb:25
  [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:21
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "qatest1@qwe.qweewsassdfdasfs"], ["id", 3], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = $1, "referrer_id" = $2 WHERE "users"."id" = $3[0m  [["updated_at", "2021-02-07 11:46:22.036293"], ["referrer_id", 1], ["id", 3]]
  â†³ app/services/users/creator.rb:10
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "qatest1@qwe.qweewsassdfdasfs"], ["id", 3], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:7
  [1m[36mUser Update All (0.5ms)[0m  [1m[33mUPDATE "users" SET "credits" = COALESCE("credits", 0) + 10 WHERE "users"."id" = $1[0m  [["id", 3]]
  â†³ app/services/credits/processor.rb:28
  [1m[36mUser Update All (0.5ms)[0m  [1m[33mUPDATE "users" SET "referral_points" = COALESCE("referral_points", 0) + 1 WHERE "users"."id" = $1[0m  [["id", 1]]
  â†³ app/services/credits/processor.rb:40
Completed 200 OK in 267ms (Views: 0.3ms | ActiveRecord: 4.6ms)


Started POST "/sign_up?referrer_id=1" for ::1 at 2021-02-07 14:46:32 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"qatest1@qwe.qweewsassdfdasf", "password"=>"[FILTERED]", "referrer_id"=>"1", "registration"=>{"email"=>"qatest1@qwe.qweewsassdfdasf", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "qatest1@qwe.qweewsassdfdasf"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["email", "qatest1@qwe.qweewsassdfdasf"], ["password_digest", "$2a$12$wn93iTUiLq8jBiAog1L6GerRn1bIcfAxWqvFELqaCr89a1sia0BTS"], ["created_at", "2021-02-07 11:46:33.225393"], ["updated_at", "2021-02-07 11:46:33.225393"]]
  â†³ app/services/users/creator.rb:25
  [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:21
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "qatest1@qwe.qweewsassdfdasf"], ["id", 4], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = $1, "referrer_id" = $2 WHERE "users"."id" = $3[0m  [["updated_at", "2021-02-07 11:46:33.230343"], ["referrer_id", 1], ["id", 4]]
  â†³ app/services/users/creator.rb:10
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "qatest1@qwe.qweewsassdfdasf"], ["id", 4], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:7
  [1m[36mUser Update All (0.5ms)[0m  [1m[33mUPDATE "users" SET "credits" = COALESCE("credits", 0) + 10 WHERE "users"."id" = $1[0m  [["id", 4]]
  â†³ app/services/credits/processor.rb:28
  [1m[36mUser Update All (0.5ms)[0m  [1m[33mUPDATE "users" SET "referral_points" = COALESCE("referral_points", 0) + 1 WHERE "users"."id" = $1[0m  [["id", 1]]
  â†³ app/services/credits/processor.rb:40
Completed 200 OK in 267ms (Views: 0.3ms | ActiveRecord: 4.8ms)


Started POST "/sign_up?referrer_id=1" for ::1 at 2021-02-07 14:46:40 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"qatest1@qwe.qweewsassdfdas", "password"=>"[FILTERED]", "referrer_id"=>"1", "registration"=>{"email"=>"qatest1@qwe.qweewsassdfdas", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "qatest1@qwe.qweewsassdfdas"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["email", "qatest1@qwe.qweewsassdfdas"], ["password_digest", "$2a$12$AVpu/4GpEDNaI0p/24sCHez4LXitux23DPjGScPfcD0U2.c7tncPi"], ["created_at", "2021-02-07 11:46:40.705592"], ["updated_at", "2021-02-07 11:46:40.705592"]]
  â†³ app/services/users/creator.rb:25
  [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:21
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "qatest1@qwe.qweewsassdfdas"], ["id", 5], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = $1, "referrer_id" = $2 WHERE "users"."id" = $3[0m  [["updated_at", "2021-02-07 11:46:40.710549"], ["referrer_id", 1], ["id", 5]]
  â†³ app/services/users/creator.rb:10
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "qatest1@qwe.qweewsassdfdas"], ["id", 5], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:7
  [1m[36mUser Update All (0.5ms)[0m  [1m[33mUPDATE "users" SET "credits" = COALESCE("credits", 0) + 10 WHERE "users"."id" = $1[0m  [["id", 5]]
  â†³ app/services/credits/processor.rb:28
  [1m[36mUser Update All (0.5ms)[0m  [1m[33mUPDATE "users" SET "referral_points" = COALESCE("referral_points", 0) + 1 WHERE "users"."id" = $1[0m  [["id", 1]]
  â†³ app/services/credits/processor.rb:40
Completed 200 OK in 261ms (Views: 0.2ms | ActiveRecord: 4.6ms)


Started POST "/sign_up?referrer_id=1" for ::1 at 2021-02-07 14:46:49 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"qatest1@qwe.qweewsassdfds", "password"=>"[FILTERED]", "referrer_id"=>"1", "registration"=>{"email"=>"qatest1@qwe.qweewsassdfds", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "qatest1@qwe.qweewsassdfds"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["email", "qatest1@qwe.qweewsassdfds"], ["password_digest", "$2a$12$IFj1aNhtRnmV2Pgm6rZqxO01.RLByCxIBqKvb/twiJ8Bzp/Xb.hEG"], ["created_at", "2021-02-07 11:46:50.018474"], ["updated_at", "2021-02-07 11:46:50.018474"]]
  â†³ app/services/users/creator.rb:25
  [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:21
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "qatest1@qwe.qweewsassdfds"], ["id", 6], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = $1, "referrer_id" = $2 WHERE "users"."id" = $3[0m  [["updated_at", "2021-02-07 11:46:50.023434"], ["referrer_id", 1], ["id", 6]]
  â†³ app/services/users/creator.rb:10
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "qatest1@qwe.qweewsassdfds"], ["id", 6], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:7
  [1m[36mUser Update All (0.5ms)[0m  [1m[33mUPDATE "users" SET "credits" = COALESCE("credits", 0) + 10 WHERE "users"."id" = $1[0m  [["id", 6]]
  â†³ app/services/credits/processor.rb:28
  [1m[36mUser Update All (0.5ms)[0m  [1m[33mUPDATE "users" SET "referral_points" = COALESCE("referral_points", 0) + 1 WHERE "users"."id" = $1[0m  [["id", 1]]
  â†³ app/services/credits/processor.rb:40
  [1m[36mUser Update All (0.5ms)[0m  [1m[33mUPDATE "users" SET "credits" = COALESCE("credits", 0) + 10 WHERE "users"."id" = $1[0m  [["id", 1]]
  â†³ app/services/credits/processor.rb:47
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/credits/processor.rb:48
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "qatest1@qwe.qweewsassdfdasfsdf"], ["id", 1], ["LIMIT", 1]]
  â†³ app/services/credits/processor.rb:48
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/services/credits/processor.rb:48
Completed 422 Unprocessable Entity in 267ms (ActiveRecord: 5.6ms)


  
ActiveRecord::RecordInvalid (Validation failed: Password can't be blank):
  
app/services/credits/processor.rb:48:in `process_referrer'
app/services/credits/processor.rb:12:in `run'
app/controllers/registrations_controller.rb:8:in `create'
Started POST "/sign_up?referrer_id=1" for ::1 at 2021-02-07 14:47:25 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"qatest1@qwe.qweewsassdfd", "password"=>"[FILTERED]", "referrer_id"=>"1", "registration"=>{"email"=>"qatest1@qwe.qweewsassdfd", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "qatest1@qwe.qweewsassdfd"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["email", "qatest1@qwe.qweewsassdfd"], ["password_digest", "$2a$12$N/l396HDIUvDAvdENbYzhORM2BipCJTbSAMTpON8eMBKhVi.E3tU."], ["created_at", "2021-02-07 11:47:25.734267"], ["updated_at", "2021-02-07 11:47:25.734267"]]
  â†³ app/services/users/creator.rb:25
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:21
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "qatest1@qwe.qweewsassdfd"], ["id", 7], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = $1, "referrer_id" = $2 WHERE "users"."id" = $3[0m  [["updated_at", "2021-02-07 11:47:25.738757"], ["referrer_id", 1], ["id", 7]]
  â†³ app/services/users/creator.rb:10
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "qatest1@qwe.qweewsassdfd"], ["id", 7], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:7
Completed 200 OK in 284ms (Views: 0.3ms | ActiveRecord: 9.3ms)


Started POST "/sign_up?referrer_id=5" for ::1 at 2021-02-07 14:50:32 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"qatest1@qwe.qweewsassdfdasfsdf", "password"=>"[FILTERED]", "referrer_id"=>"5", "registration"=>{"email"=>"qatest1@qwe.qweewsassdfdasfsdf", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "qatest1@qwe.qweewsassdfdasfsdf"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:25
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/services/users/creator.rb:25
Completed 422 Unprocessable Entity in 269ms (ActiveRecord: 7.8ms)


  
ActiveRecord::RecordInvalid (Validation failed: Email has already been taken):
  
app/services/users/creator.rb:25:in `user'
app/services/users/creator.rb:8:in `create'
app/controllers/registrations_controller.rb:23:in `user'
app/controllers/registrations_controller.rb:5:in `create'
Started POST "/sign_up?referrer_id=5" for ::1 at 2021-02-07 14:50:42 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"qatest1@qwe.qweewsassdfdasfsd", "password"=>"[FILTERED]", "referrer_id"=>"5", "registration"=>{"email"=>"qatest1@qwe.qweewsassdfdasfsd", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "qatest1@qwe.qweewsassdfdasfsd"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:25
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/services/users/creator.rb:25
Completed 422 Unprocessable Entity in 255ms (ActiveRecord: 0.7ms)


  
ActiveRecord::RecordInvalid (Validation failed: Email has already been taken):
  
app/services/users/creator.rb:25:in `user'
app/services/users/creator.rb:8:in `create'
app/controllers/registrations_controller.rb:23:in `user'
app/controllers/registrations_controller.rb:5:in `create'
Started POST "/sign_up?referrer_id=5" for ::1 at 2021-02-07 14:50:53 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"qatest1@qwe.qweewsassasfsd", "password"=>"[FILTERED]", "referrer_id"=>"5", "registration"=>{"email"=>"qatest1@qwe.qweewsassasfsd", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "qatest1@qwe.qweewsassasfsd"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["email", "qatest1@qwe.qweewsassasfsd"], ["password_digest", "$2a$12$sDhDtgxWAw0etd0Y4oEDa.M/JZdF50B8jnyQx/Z.AjIqvQ9uLDS8m"], ["created_at", "2021-02-07 11:50:53.954232"], ["updated_at", "2021-02-07 11:50:53.954232"]]
  â†³ app/services/users/creator.rb:25
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:21
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "qatest1@qwe.qweewsassasfsd"], ["id", 8], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = $1, "referrer_id" = $2 WHERE "users"."id" = $3[0m  [["updated_at", "2021-02-07 11:50:53.960384"], ["referrer_id", 5], ["id", 8]]
  â†³ app/services/users/creator.rb:10
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "qatest1@qwe.qweewsassasfsd"], ["id", 8], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:7
Completed 200 OK in 264ms (Views: 0.3ms | ActiveRecord: 4.0ms)


  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" ORDER BY "users"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
Started POST "/sign_up?referrer_id=5" for ::1 at 2021-02-07 14:52:32 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"qatest1@qwe.qweewsassasfsd", "password"=>"[FILTERED]", "referrer_id"=>"5", "registration"=>{"email"=>"qatest1@qwe.qweewsassasfsd", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "qatest1@qwe.qweewsassasfsd"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:25
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/services/users/creator.rb:25
Completed 422 Unprocessable Entity in 256ms (ActiveRecord: 0.8ms)


  
ActiveRecord::RecordInvalid (Validation failed: Email has already been taken):
  
app/services/users/creator.rb:25:in `user'
app/services/users/creator.rb:8:in `create'
app/controllers/registrations_controller.rb:23:in `user'
app/controllers/registrations_controller.rb:5:in `create'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users"[0m
Started POST "/sign_up?referrer_id=5" for ::1 at 2021-02-07 14:54:21 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"qatest1@qwe.qweewsassasfsd", "password"=>"[FILTERED]", "referrer_id"=>"5", "registration"=>{"email"=>"qatest1@qwe.qweewsassasfsd", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "qatest1@qwe.qweewsassasfsd"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:25
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/services/users/creator.rb:25
Completed 422 Unprocessable Entity in 257ms (ActiveRecord: 0.8ms)


  
ActiveRecord::RecordInvalid (Validation failed: Email has already been taken):
  
app/services/users/creator.rb:25:in `user'
app/services/users/creator.rb:8:in `create'
app/controllers/registrations_controller.rb:23:in `user'
app/controllers/registrations_controller.rb:5:in `create'
Started POST "/sign_up?referrer_id=5" for ::1 at 2021-02-07 14:55:16 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"1@qwe.sjdfajfdoasifdjoasifj", "password"=>"[FILTERED]", "referrer_id"=>"5", "registration"=>{"email"=>"1@qwe.sjdfajfdoasifdjoasifj", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "1@qwe.sjdfajfdoasifdjoasifj"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["email", "1@qwe.sjdfajfdoasifdjoasifj"], ["password_digest", "$2a$12$3LbJr27OGG0mMedHHA8e8eYkPKW8UetlaTVH38LXswTJjjoRH0Ny."], ["created_at", "2021-02-07 11:55:16.494295"], ["updated_at", "2021-02-07 11:55:16.494295"]]
  â†³ app/services/users/creator.rb:25
  [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:21
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "1@qwe.sjdfajfdoasifdjoasifj"], ["id", 9], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = $1, "referrer_id" = $2 WHERE "users"."id" = $3[0m  [["updated_at", "2021-02-07 11:55:16.499225"], ["referrer_id", 5], ["id", 9]]
  â†³ app/services/users/creator.rb:10
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "1@qwe.sjdfajfdoasifdjoasifj"], ["id", 9], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:7
Completed 200 OK in 264ms (Views: 0.3ms | ActiveRecord: 3.7ms)


Started POST "/sign_up?referrer_id=5" for ::1 at 2021-02-07 14:55:26 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"1@qwe.sjdfajfdoasifdjoasif", "password"=>"[FILTERED]", "referrer_id"=>"5", "registration"=>{"email"=>"1@qwe.sjdfajfdoasifdjoasif", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "1@qwe.sjdfajfdoasifdjoasif"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["email", "1@qwe.sjdfajfdoasifdjoasif"], ["password_digest", "$2a$12$wHdS9oxpr1oais2VvOZYieNjxutjOUlvGont3Dnoy0/72h1CnxZPS"], ["created_at", "2021-02-07 11:55:26.341726"], ["updated_at", "2021-02-07 11:55:26.341726"]]
  â†³ app/services/users/creator.rb:25
  [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:21
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "1@qwe.sjdfajfdoasifdjoasif"], ["id", 10], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = $1, "referrer_id" = $2 WHERE "users"."id" = $3[0m  [["updated_at", "2021-02-07 11:55:26.346582"], ["referrer_id", 5], ["id", 10]]
  â†³ app/services/users/creator.rb:10
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "1@qwe.sjdfajfdoasifdjoasif"], ["id", 10], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:7
Completed 200 OK in 264ms (Views: 0.3ms | ActiveRecord: 3.9ms)


Started POST "/sign_up?referrer_id=5" for ::1 at 2021-02-07 14:55:34 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"1@qwe.sjdfajfdoasifdjoasf", "password"=>"[FILTERED]", "referrer_id"=>"5", "registration"=>{"email"=>"1@qwe.sjdfajfdoasifdjoasf", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "1@qwe.sjdfajfdoasifdjoasf"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["email", "1@qwe.sjdfajfdoasifdjoasf"], ["password_digest", "$2a$12$LbAjLR4X3kvp/x14Hs2VTuPuGi4mR32n0FB2fjBu1PqjJcxqa5gay"], ["created_at", "2021-02-07 11:55:34.500827"], ["updated_at", "2021-02-07 11:55:34.500827"]]
  â†³ app/services/users/creator.rb:25
  [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:21
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "1@qwe.sjdfajfdoasifdjoasf"], ["id", 11], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = $1, "referrer_id" = $2 WHERE "users"."id" = $3[0m  [["updated_at", "2021-02-07 11:55:34.505662"], ["referrer_id", 5], ["id", 11]]
  â†³ app/services/users/creator.rb:10
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "1@qwe.sjdfajfdoasifdjoasf"], ["id", 11], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:7
Completed 200 OK in 266ms (Views: 0.3ms | ActiveRecord: 3.6ms)


Started POST "/sign_up?referrer_id=5" for ::1 at 2021-02-07 14:55:41 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"1@qwe.sjdfajfdoasifdjoas", "password"=>"[FILTERED]", "referrer_id"=>"5", "registration"=>{"email"=>"1@qwe.sjdfajfdoasifdjoas", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "1@qwe.sjdfajfdoasifdjoas"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["email", "1@qwe.sjdfajfdoasifdjoas"], ["password_digest", "$2a$12$Kupnrh/ANA7eOEWDlgobHOjC0CNwQbONc82GY11qHHBYnIdI3bpaS"], ["created_at", "2021-02-07 11:55:41.836632"], ["updated_at", "2021-02-07 11:55:41.836632"]]
  â†³ app/services/users/creator.rb:25
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:21
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "1@qwe.sjdfajfdoasifdjoas"], ["id", 12], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = $1, "referrer_id" = $2 WHERE "users"."id" = $3[0m  [["updated_at", "2021-02-07 11:55:41.841353"], ["referrer_id", 5], ["id", 12]]
  â†³ app/services/users/creator.rb:10
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "1@qwe.sjdfajfdoasifdjoas"], ["id", 12], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:7
Completed 200 OK in 259ms (Views: 0.3ms | ActiveRecord: 3.7ms)


  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users"[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users"[0m
Started POST "/sign_up?referrer_id=5" for ::1 at 2021-02-07 14:57:25 +0300
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /Users/Alex/.rvm/gems/ruby-2.7.2/gems/activerecord-5.2.4.4/lib/active_record/log_subscriber.rb:98
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"1@qwe.sjdfajfdoasifdjoas", "password"=>"[FILTERED]", "referrer_id"=>"5", "registration"=>{"email"=>"1@qwe.sjdfajfdoasifdjoas", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "1@qwe.sjdfajfdoasifdjoas"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:25
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/services/users/creator.rb:25
Completed 422 Unprocessable Entity in 278ms (ActiveRecord: 8.7ms)


  
ActiveRecord::RecordInvalid (Validation failed: Email has already been taken):
  
app/services/users/creator.rb:25:in `user'
app/services/users/creator.rb:8:in `create'
app/controllers/registrations_controller.rb:23:in `user'
app/controllers/registrations_controller.rb:5:in `create'
Started POST "/sign_up?referrer_id=5" for ::1 at 2021-02-07 14:57:33 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"1@qwe.sjdfajfdoasifdjoa", "password"=>"[FILTERED]", "referrer_id"=>"5", "registration"=>{"email"=>"1@qwe.sjdfajfdoasifdjoa", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "1@qwe.sjdfajfdoasifdjoa"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["email", "1@qwe.sjdfajfdoasifdjoa"], ["password_digest", "$2a$12$cYxtLeCvN7MnwQTBjlk7auXZ/9vUrAGmCoamA2asTDczK.HWO2eiS"], ["created_at", "2021-02-07 11:57:33.333500"], ["updated_at", "2021-02-07 11:57:33.333500"]]
  â†³ app/services/users/creator.rb:25
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:21
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "1@qwe.sjdfajfdoasifdjoa"], ["id", 13], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = $1, "referrer_id" = $2 WHERE "users"."id" = $3[0m  [["updated_at", "2021-02-07 11:57:33.342877"], ["referrer_id", 5], ["id", 13]]
  â†³ app/services/users/creator.rb:10
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "1@qwe.sjdfajfdoasifdjoa"], ["id", 13], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:7
Completed 200 OK in 266ms (Views: 0.4ms | ActiveRecord: 4.4ms)


Started POST "/sign_up?referrer_id=5" for ::1 at 2021-02-07 14:57:52 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"1@qwe.sjdfajfdoasifdjo", "password"=>"[FILTERED]", "referrer_id"=>"5", "registration"=>{"email"=>"1@qwe.sjdfajfdoasifdjo", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "1@qwe.sjdfajfdoasifdjo"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["email", "1@qwe.sjdfajfdoasifdjo"], ["password_digest", "$2a$12$U9.M0bXupe63T7iH0Oe8EOJ.UQGsYasMTESMx66CxGCawA5m8C0ju"], ["created_at", "2021-02-07 11:57:52.769906"], ["updated_at", "2021-02-07 11:57:52.769906"]]
  â†³ app/services/users/creator.rb:25
  [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:21
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "1@qwe.sjdfajfdoasifdjo"], ["id", 14], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = $1, "referrer_id" = $2 WHERE "users"."id" = $3[0m  [["updated_at", "2021-02-07 11:57:52.776093"], ["referrer_id", 5], ["id", 14]]
  â†³ app/services/users/creator.rb:10
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "1@qwe.sjdfajfdoasifdjo"], ["id", 14], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:7
Completed 200 OK in 45907ms (Views: 0.6ms | ActiveRecord: 13.1ms)


Started POST "/sign_up?referrer_id=5" for ::1 at 2021-02-07 14:58:50 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"1@qwe.sjdfajfdoasifdo", "password"=>"[FILTERED]", "referrer_id"=>"5", "registration"=>{"email"=>"1@qwe.sjdfajfdoasifdo", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "1@qwe.sjdfajfdoasifdo"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["email", "1@qwe.sjdfajfdoasifdo"], ["password_digest", "$2a$12$.fJhcZW1d6SxygMeyrjQW.MzN19NOVjW.wZ3HKelmxIayflJDyDW2"], ["created_at", "2021-02-07 11:58:51.236011"], ["updated_at", "2021-02-07 11:58:51.236011"]]
  â†³ app/services/users/creator.rb:25
  [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:21
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "1@qwe.sjdfajfdoasifdo"], ["id", 15], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = $1, "referrer_id" = $2 WHERE "users"."id" = $3[0m  [["updated_at", "2021-02-07 11:58:51.241164"], ["referrer_id", 5], ["id", 15]]
  â†³ app/services/users/creator.rb:10
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "1@qwe.sjdfajfdoasifdo"], ["id", 15], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:7
Completed 200 OK in 1842ms (Views: 0.4ms | ActiveRecord: 3.7ms)


  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
Started POST "/sign_up?referrer_id=5" for ::1 at 2021-02-07 15:00:18 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"1@qwe.sjdfajfdoasifo", "password"=>"[FILTERED]", "referrer_id"=>"5", "registration"=>{"email"=>"1@qwe.sjdfajfdoasifo", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "1@qwe.sjdfajfdoasifo"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["email", "1@qwe.sjdfajfdoasifo"], ["password_digest", "$2a$12$lzMUXKFcLFuTNU/c0CmpvOXuOcGe1zCxZ420qBGOp2waxNGo6qf2y"], ["created_at", "2021-02-07 12:00:19.292722"], ["updated_at", "2021-02-07 12:00:19.292722"]]
  â†³ app/services/users/creator.rb:25
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:21
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "1@qwe.sjdfajfdoasifo"], ["id", 16], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = $1, "referrer_id" = $2 WHERE "users"."id" = $3[0m  [["updated_at", "2021-02-07 12:00:19.298834"], ["referrer_id", 5], ["id", 16]]
  â†³ app/services/users/creator.rb:10
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "1@qwe.sjdfajfdoasifo"], ["id", 16], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:7
Completed 200 OK in 39338ms (Views: 0.4ms | ActiveRecord: 9.8ms)


Started POST "/sign_up?referrer_id=5" for ::1 at 2021-02-07 15:01:19 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"1@qwe.sjdfajfdoasif", "password"=>"[FILTERED]", "referrer_id"=>"5", "registration"=>{"email"=>"1@qwe.sjdfajfdoasif", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "1@qwe.sjdfajfdoasif"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["email", "1@qwe.sjdfajfdoasif"], ["password_digest", "$2a$12$qdMCaTwB774LbUW36Mst/eUE8zu5jheS3S8cfgdjdOSE4avtOLtUm"], ["created_at", "2021-02-07 12:01:19.961233"], ["updated_at", "2021-02-07 12:01:19.961233"]]
  â†³ app/services/users/creator.rb:25
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:21
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "1@qwe.sjdfajfdoasif"], ["id", 17], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = $1, "referrer_id" = $2 WHERE "users"."id" = $3[0m  [["updated_at", "2021-02-07 12:01:19.965343"], ["referrer_id", 5], ["id", 17]]
  â†³ app/services/users/creator.rb:10
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "1@qwe.sjdfajfdoasif"], ["id", 17], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:7
Completed 200 OK in 14838ms (Views: 0.5ms | ActiveRecord: 3.1ms)


Started POST "/sign_up?referrer_id=5" for ::1 at 2021-02-07 15:03:12 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"1@qwe.sjdfajfdoasi", "password"=>"[FILTERED]", "referrer_id"=>"5", "registration"=>{"email"=>"1@qwe.sjdfajfdoasi", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "1@qwe.sjdfajfdoasi"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["email", "1@qwe.sjdfajfdoasi"], ["password_digest", "$2a$12$cxV/llYLkGdat8JMQjdNoutn7e2rrn4i.RvMRNX4ZHxRV3rExGzSC"], ["created_at", "2021-02-07 12:03:12.691412"], ["updated_at", "2021-02-07 12:03:12.691412"]]
  â†³ app/services/users/creator.rb:25
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:21
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "1@qwe.sjdfajfdoasi"], ["id", 18], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = $1, "referrer_id" = $2 WHERE "users"."id" = $3[0m  [["updated_at", "2021-02-07 12:03:12.697420"], ["referrer_id", 5], ["id", 18]]
  â†³ app/services/users/creator.rb:10
  [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "1@qwe.sjdfajfdoasi"], ["id", 18], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:7
  [1m[36mUser Update All (0.8ms)[0m  [1m[33mUPDATE "users" SET "credits" = COALESCE("credits", 0) + 10 WHERE "users"."id" = $1[0m  [["id", 18]]
  â†³ app/services/credits/processor.rb:29
  [1m[36mUser Update All (0.6ms)[0m  [1m[33mUPDATE "users" SET "referral_points" = COALESCE("referral_points", 0) + 1 WHERE "users"."id" = $1[0m  [["id", 5]]
  â†³ app/services/credits/processor.rb:41
Completed 200 OK in 283ms (Views: 0.3ms | ActiveRecord: 12.6ms)


Started POST "/sign_up?referrer_id=5" for ::1 at 2021-02-07 15:03:19 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"1@qwe.sjdfajfdoas", "password"=>"[FILTERED]", "referrer_id"=>"5", "registration"=>{"email"=>"1@qwe.sjdfajfdoas", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "1@qwe.sjdfajfdoas"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["email", "1@qwe.sjdfajfdoas"], ["password_digest", "$2a$12$ruWrugp75y65ed6SUiHeTemfujAqcSxjvTYalcagvNZRxhegwzlvK"], ["created_at", "2021-02-07 12:03:20.013574"], ["updated_at", "2021-02-07 12:03:20.013574"]]
  â†³ app/services/users/creator.rb:25
  [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:21
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "1@qwe.sjdfajfdoas"], ["id", 19], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = $1, "referrer_id" = $2 WHERE "users"."id" = $3[0m  [["updated_at", "2021-02-07 12:03:20.021809"], ["referrer_id", 5], ["id", 19]]
  â†³ app/services/users/creator.rb:10
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "1@qwe.sjdfajfdoas"], ["id", 19], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:7
  [1m[36mUser Update All (0.6ms)[0m  [1m[33mUPDATE "users" SET "credits" = COALESCE("credits", 0) + 10 WHERE "users"."id" = $1[0m  [["id", 19]]
  â†³ app/services/credits/processor.rb:29
  [1m[36mUser Update All (0.6ms)[0m  [1m[33mUPDATE "users" SET "referral_points" = COALESCE("referral_points", 0) + 1 WHERE "users"."id" = $1[0m  [["id", 5]]
  â†³ app/services/credits/processor.rb:41
Completed 200 OK in 267ms (Views: 0.3ms | ActiveRecord: 4.8ms)


Started POST "/sign_up?referrer_id=5" for ::1 at 2021-02-07 15:03:26 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"1@qwe.sjdfajfdoa", "password"=>"[FILTERED]", "referrer_id"=>"5", "registration"=>{"email"=>"1@qwe.sjdfajfdoa", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "1@qwe.sjdfajfdoa"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["email", "1@qwe.sjdfajfdoa"], ["password_digest", "$2a$12$7myxu2KgZaDBwRtjSLlWuOGqzp48j7/RRymMiZTUV.3JHGWsg5Q46"], ["created_at", "2021-02-07 12:03:27.028071"], ["updated_at", "2021-02-07 12:03:27.028071"]]
  â†³ app/services/users/creator.rb:25
  [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:21
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "1@qwe.sjdfajfdoa"], ["id", 20], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = $1, "referrer_id" = $2 WHERE "users"."id" = $3[0m  [["updated_at", "2021-02-07 12:03:27.033912"], ["referrer_id", 5], ["id", 20]]
  â†³ app/services/users/creator.rb:10
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "1@qwe.sjdfajfdoa"], ["id", 20], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:7
  [1m[36mUser Update All (0.5ms)[0m  [1m[33mUPDATE "users" SET "credits" = COALESCE("credits", 0) + 10 WHERE "users"."id" = $1[0m  [["id", 20]]
  â†³ app/services/credits/processor.rb:29
  [1m[36mUser Update All (0.5ms)[0m  [1m[33mUPDATE "users" SET "referral_points" = COALESCE("referral_points", 0) + 1 WHERE "users"."id" = $1[0m  [["id", 5]]
  â†³ app/services/credits/processor.rb:41
Completed 200 OK in 264ms (Views: 0.2ms | ActiveRecord: 4.9ms)


  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users"[0m
Started POST "/sign_up?referrer_id=5" for ::1 at 2021-02-07 15:03:42 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"1@qwe.sjdfajfdo", "password"=>"[FILTERED]", "referrer_id"=>"5", "registration"=>{"email"=>"1@qwe.sjdfajfdo", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "1@qwe.sjdfajfdo"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["email", "1@qwe.sjdfajfdo"], ["password_digest", "$2a$12$LapFKIUBn7kAJ6hYefc.4OEp9.1QQJeGFOchBIEvJBBN3j1uMyyg2"], ["created_at", "2021-02-07 12:03:42.878601"], ["updated_at", "2021-02-07 12:03:42.878601"]]
  â†³ app/services/users/creator.rb:25
  [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:21
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "1@qwe.sjdfajfdo"], ["id", 21], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = $1, "referrer_id" = $2 WHERE "users"."id" = $3[0m  [["updated_at", "2021-02-07 12:03:42.883881"], ["referrer_id", 5], ["id", 21]]
  â†³ app/services/users/creator.rb:10
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "1@qwe.sjdfajfdo"], ["id", 21], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:7
  [1m[36mUser Update All (0.6ms)[0m  [1m[33mUPDATE "users" SET "credits" = COALESCE("credits", 0) + 10 WHERE "users"."id" = $1[0m  [["id", 21]]
  â†³ app/services/credits/processor.rb:29
  [1m[36mUser Update All (0.5ms)[0m  [1m[33mUPDATE "users" SET "referral_points" = COALESCE("referral_points", 0) + 1 WHERE "users"."id" = $1[0m  [["id", 5]]
  â†³ app/services/credits/processor.rb:41
Completed 200 OK in 262ms (Views: 0.3ms | ActiveRecord: 5.3ms)


Started POST "/sign_up?referrer_id=5" for ::1 at 2021-02-07 15:03:49 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"1@qwe.sjdfajfd", "password"=>"[FILTERED]", "referrer_id"=>"5", "registration"=>{"email"=>"1@qwe.sjdfajfd", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "1@qwe.sjdfajfd"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["email", "1@qwe.sjdfajfd"], ["password_digest", "$2a$12$6Km573mu9wwKjSNYTw2wPeG40LvpF0u2.TmQHbjjAvn.JvnJu8tkC"], ["created_at", "2021-02-07 12:03:50.154859"], ["updated_at", "2021-02-07 12:03:50.154859"]]
  â†³ app/services/users/creator.rb:25
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:21
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "1@qwe.sjdfajfd"], ["id", 22], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = $1, "referrer_id" = $2 WHERE "users"."id" = $3[0m  [["updated_at", "2021-02-07 12:03:50.159185"], ["referrer_id", 5], ["id", 22]]
  â†³ app/services/users/creator.rb:10
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "1@qwe.sjdfajfd"], ["id", 22], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:7
  [1m[36mUser Update All (0.5ms)[0m  [1m[33mUPDATE "users" SET "credits" = COALESCE("credits", 0) + 10 WHERE "users"."id" = $1[0m  [["id", 22]]
  â†³ app/services/credits/processor.rb:29
  [1m[36mUser Update All (0.5ms)[0m  [1m[33mUPDATE "users" SET "referral_points" = COALESCE("referral_points", 0) + 1 WHERE "users"."id" = $1[0m  [["id", 5]]
  â†³ app/services/credits/processor.rb:41
  [1m[36mUser Update All (0.5ms)[0m  [1m[33mUPDATE "users" SET "credits" = COALESCE("credits", 0) + 10 WHERE "users"."id" = $1[0m  [["id", 5]]
  â†³ app/services/credits/processor.rb:48
  [1m[36mUser Update All (0.6ms)[0m  [1m[33mUPDATE "users" SET "referral_points" = COALESCE("referral_points", 0) - 5 WHERE "users"."id" = $1[0m  [["id", 5]]
  â†³ app/services/credits/processor.rb:49
Completed 200 OK in 271ms (Views: 0.4ms | ActiveRecord: 5.5ms)


Started POST "/sign_up?referrer_id=5" for ::1 at 2021-02-07 15:05:13 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"1@qwe.sjdfajfd", "password"=>"[FILTERED]", "referrer_id"=>"5", "registration"=>{"email"=>"1@qwe.sjdfajfd", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:29
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "1@qwe.sjdfajfd"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:29
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/services/users/creator.rb:29
Completed 422 Unprocessable Entity in 281ms (ActiveRecord: 7.6ms)


  
ActiveRecord::RecordInvalid (Validation failed: Email has already been taken):
  
app/services/users/creator.rb:29:in `user'
app/services/users/creator.rb:9:in `create'
app/controllers/registrations_controller.rb:25:in `user'
app/controllers/registrations_controller.rb:6:in `create'
Started POST "/sign_up?referrer_id=5" for ::1 at 2021-02-07 15:05:25 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"1@qwe.sjdajfd", "password"=>"[FILTERED]", "referrer_id"=>"5", "registration"=>{"email"=>"1@qwe.sjdajfd", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:29
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "1@qwe.sjdajfd"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:29
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["email", "1@qwe.sjdajfd"], ["password_digest", "$2a$12$9IsVR6ipwbiqMXJncZOXtOM8tSzXFQ1D5b0qUI33vNREqYaaN.zTO"], ["created_at", "2021-02-07 12:05:25.409951"], ["updated_at", "2021-02-07 12:05:25.409951"]]
  â†³ app/services/users/creator.rb:29
  [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:29
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:25
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:12
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "1@qwe.sjdajfd"], ["id", 23], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:12
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = $1, "referrer_id" = $2 WHERE "users"."id" = $3[0m  [["updated_at", "2021-02-07 12:05:25.415926"], ["referrer_id", 5], ["id", 23]]
  â†³ app/services/users/creator.rb:12
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:12
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "1@qwe.sjdajfd"], ["id", 23], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:9
  [1m[36mUser Update All (0.6ms)[0m  [1m[33mUPDATE "users" SET "credits" = COALESCE("credits", 0) + 10 WHERE "users"."id" = $1[0m  [["id", 23]]
  â†³ app/services/credits/processor.rb:29
  [1m[36mUser Update All (0.5ms)[0m  [1m[33mUPDATE "users" SET "referral_points" = COALESCE("referral_points", 0) + 1 WHERE "users"."id" = $1[0m  [["id", 5]]
  â†³ app/services/credits/processor.rb:41
Completed 200 OK in 265ms (Views: 0.3ms | ActiveRecord: 4.8ms)


Started POST "/sign_up?referrer_id=5" for ::1 at 2021-02-07 15:05:48 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"1@qwe.sjdajf", "password"=>"[FILTERED]", "referrer_id"=>"5", "registration"=>{"email"=>"1@qwe.sjdajf", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:29
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "1@qwe.sjdajf"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:29
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["email", "1@qwe.sjdajf"], ["password_digest", "$2a$12$8G7GbdFiG01DDCZHAGbzDuKaVkfHOwzmdvoKxnd.i1094c0mN3gOu"], ["created_at", "2021-02-07 12:05:48.517376"], ["updated_at", "2021-02-07 12:05:48.517376"]]
  â†³ app/services/users/creator.rb:29
  [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:29
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:25
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:12
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "1@qwe.sjdajf"], ["id", 24], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:12
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = $1, "referrer_id" = $2 WHERE "users"."id" = $3[0m  [["updated_at", "2021-02-07 12:05:48.522491"], ["referrer_id", 5], ["id", 24]]
  â†³ app/services/users/creator.rb:12
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:12
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "1@qwe.sjdajf"], ["id", 24], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:9
  [1m[36mUser Update All (0.6ms)[0m  [1m[33mUPDATE "users" SET "credits" = COALESCE("credits", 0) + 10 WHERE "users"."id" = $1[0m  [["id", 24]]
  â†³ app/services/credits/processor.rb:29
  [1m[36mUser Update All (0.6ms)[0m  [1m[33mUPDATE "users" SET "referral_points" = COALESCE("referral_points", 0) + 1 WHERE "users"."id" = $1[0m  [["id", 5]]
  â†³ app/services/credits/processor.rb:41
Completed 200 OK in 263ms (Views: 0.3ms | ActiveRecord: 4.8ms)


Started POST "/sign_up" for ::1 at 2021-02-07 15:11:46 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"1@qwe.sjdaj", "password"=>"[FILTERED]", "registration"=>{"email"=>"1@qwe.sjdaj", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:29
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "1@qwe.sjdaj"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:29
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["email", "1@qwe.sjdaj"], ["password_digest", "$2a$12$zRt4AJ1fYDFEWouPnFclAu4hz3vgPlncRJRmjwkhbdGb07acBfjaW"], ["created_at", "2021-02-07 12:11:46.534557"], ["updated_at", "2021-02-07 12:11:46.534557"]]
  â†³ app/services/users/creator.rb:29
  [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:29
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" IS NULL LIMIT $1[0m  [["LIMIT", 1]]
  â†³ app/services/users/creator.rb:25
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" IS NULL LIMIT $1[0m  [["LIMIT", 1]]
  â†³ app/services/users/creator.rb:25
Completed 500 Internal Server Error in 275ms (ActiveRecord: 10.4ms)


  
NoMethodError (undefined method `id' for nil:NilClass):
  
app/services/users/creator.rb:14:in `create'
app/controllers/registrations_controller.rb:25:in `user'
app/controllers/registrations_controller.rb:6:in `create'
Started POST "/sign_up" for ::1 at 2021-02-07 15:12:07 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"1@qwe.sjdaj", "password"=>"[FILTERED]", "registration"=>{"email"=>"1@qwe.sjdaj", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:29
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "1@qwe.sjdaj"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:29
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/services/users/creator.rb:29
Completed 422 Unprocessable Entity in 269ms (ActiveRecord: 6.9ms)


  
ActiveRecord::RecordInvalid (Validation failed: Email has already been taken):
  
app/services/users/creator.rb:29:in `user'
app/services/users/creator.rb:9:in `create'
app/controllers/registrations_controller.rb:25:in `user'
app/controllers/registrations_controller.rb:6:in `create'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" ORDER BY "users"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
Started POST "/sign_up" for ::1 at 2021-02-07 17:56:47 +0300
  [1m[35m (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /Users/Alex/.rvm/gems/ruby-2.7.2/gems/activerecord-5.2.4.4/lib/active_record/log_subscriber.rb:98
  
ActiveRecord::PendingMigrationError (

Migrations are pending. To resolve this issue, run:

        bin/rails db:migrate RAILS_ENV=development

):
  
activerecord (5.2.4.4) lib/active_record/migration.rb:579:in `check_pending!'
activerecord (5.2.4.4) lib/active_record/migration.rb:556:in `call'
actionpack (5.2.4.4) lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'
activesupport (5.2.4.4) lib/active_support/callbacks.rb:98:in `run_callbacks'
actionpack (5.2.4.4) lib/action_dispatch/middleware/callbacks.rb:26:in `call'
actionpack (5.2.4.4) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (5.2.4.4) lib/action_dispatch/middleware/debug_exceptions.rb:61:in `call'
actionpack (5.2.4.4) lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
railties (5.2.4.4) lib/rails/rack/logger.rb:38:in `call_app'
railties (5.2.4.4) lib/rails/rack/logger.rb:26:in `block in call'
activesupport (5.2.4.4) lib/active_support/tagged_logging.rb:71:in `block in tagged'
activesupport (5.2.4.4) lib/active_support/tagged_logging.rb:28:in `tagged'
activesupport (5.2.4.4) lib/active_support/tagged_logging.rb:71:in `tagged'
railties (5.2.4.4) lib/rails/rack/logger.rb:26:in `call'
actionpack (5.2.4.4) lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
actionpack (5.2.4.4) lib/action_dispatch/middleware/request_id.rb:27:in `call'
rack (2.2.3) lib/rack/runtime.rb:22:in `call'
activesupport (5.2.4.4) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (5.2.4.4) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (5.2.4.4) lib/action_dispatch/middleware/static.rb:127:in `call'
rack (2.2.3) lib/rack/sendfile.rb:110:in `call'
railties (5.2.4.4) lib/rails/engine.rb:524:in `call'
puma (3.12.6) lib/puma/configuration.rb:227:in `call'
puma (3.12.6) lib/puma/server.rb:706:in `handle_request'
puma (3.12.6) lib/puma/server.rb:476:in `process_client'
puma (3.12.6) lib/puma/server.rb:334:in `block in run'
puma (3.12.6) lib/puma/thread_pool.rb:135:in `block in spawn_thread'
Started POST "/sign_up" for ::1 at 2021-02-07 17:57:08 +0300
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /Users/Alex/.rvm/gems/ruby-2.7.2/gems/activerecord-5.2.4.4/lib/active_record/log_subscriber.rb:98
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"1@qwe.sjda", "password"=>"[FILTERED]", "registration"=>{"email"=>"1@qwe.sjda", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
Completed 500 Internal Server Error in 3ms (ActiveRecord: 0.0ms)


  
ArgumentError (wrong number of arguments (given 2, expected 0..1)):
  
app/models/user.rb:5:in `<class:User>'
app/models/user.rb:1:in `<main>'
app/services/users/creator.rb:29:in `user'
app/services/users/creator.rb:9:in `create'
app/controllers/registrations_controller.rb:25:in `user'
app/controllers/registrations_controller.rb:6:in `create'
Started POST "/sign_up" for ::1 at 2021-02-07 17:57:25 +0300
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /Users/Alex/.rvm/gems/ruby-2.7.2/gems/activerecord-5.2.4.4/lib/active_record/log_subscriber.rb:98
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"1@qwe.sjda", "password"=>"[FILTERED]", "registration"=>{"email"=>"1@qwe.sjda", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
Completed 500 Internal Server Error in 2ms (ActiveRecord: 0.0ms)


  
ArgumentError (wrong number of arguments (given 2, expected 0..1)):
  
app/models/user.rb:5:in `<class:User>'
app/models/user.rb:1:in `<main>'
app/services/users/creator.rb:29:in `user'
app/services/users/creator.rb:9:in `create'
app/controllers/registrations_controller.rb:25:in `user'
app/controllers/registrations_controller.rb:6:in `create'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_try_advisory_lock(952323785618856000)[0m
  â†³ bin/rails:9
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
Migrating to AddReferralCodeToUsers (20210207145521)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "users" ADD "referral_code" character varying[0m
  â†³ db/migrate/20210207145521_add_referral_code_to_users.rb:3
  [1m[35m (1.5ms)[0m  [1m[35mCREATE UNIQUE INDEX  "index_users_on_referral_code" ON "users"  ("referral_code")[0m
  â†³ db/migrate/20210207145521_add_referral_code_to_users.rb:4
  [1m[36mActiveRecord::SchemaMigration Create (0.5ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20210207145521"]]
  â†³ bin/rails:9
  [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
  â†³ bin/rails:9
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  â†³ bin/rails:9
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ bin/rails:9
  [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ bin/rails:9
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(952323785618856000)[0m
  â†³ bin/rails:9
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ bin/rails:9
Started POST "/sign_up" for ::1 at 2021-02-07 18:07:12 +0300
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /Users/Alex/.rvm/gems/ruby-2.7.2/gems/activerecord-5.2.4.4/lib/active_record/log_subscriber.rb:98
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"1@qwe.sjda", "password"=>"[FILTERED]", "registration"=>{"email"=>"1@qwe.sjda", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
Completed 500 Internal Server Error in 3ms (ActiveRecord: 0.0ms)


  
ArgumentError (wrong number of arguments (given 2, expected 0..1)):
  
app/models/user.rb:5:in `<class:User>'
app/models/user.rb:1:in `<main>'
app/services/users/creator.rb:29:in `user'
app/services/users/creator.rb:9:in `create'
app/controllers/registrations_controller.rb:25:in `user'
app/controllers/registrations_controller.rb:6:in `create'
Started POST "/sign_up" for ::1 at 2021-02-07 18:08:20 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"1@qwe.sjda", "password"=>"[FILTERED]", "registration"=>{"email"=>"1@qwe.sjda", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
Completed 500 Internal Server Error in 4ms (ActiveRecord: 0.0ms)


  
ArgumentError (wrong number of arguments (given 2, expected 0..1)):
  
app/models/user.rb:5:in `<class:User>'
app/models/user.rb:1:in `<main>'
app/services/users/creator.rb:29:in `user'
app/services/users/creator.rb:9:in `create'
app/controllers/registrations_controller.rb:25:in `user'
app/controllers/registrations_controller.rb:6:in `create'
Started POST "/sign_up" for ::1 at 2021-02-07 18:08:39 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"1@qwe.sjda", "password"=>"[FILTERED]", "registration"=>{"email"=>"1@qwe.sjda", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:29
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "1@qwe.sjda"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:29
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at", "referral_code") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["email", "1@qwe.sjda"], ["password_digest", "$2a$12$K89lO1u6Dp09BwR6xB2dy.3kyI5AWpWSLiVBytRgSudwZb83al9cq"], ["created_at", "2021-02-07 15:08:40.118249"], ["updated_at", "2021-02-07 15:08:40.118249"], ["referral_code", "gkgwaHrQrgPRRR7aHTvScstr"]]
  â†³ app/services/users/creator.rb:29
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:29
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" IS NULL LIMIT $1[0m  [["LIMIT", 1]]
  â†³ app/services/users/creator.rb:25
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" IS NULL LIMIT $1[0m  [["LIMIT", 1]]
  â†³ app/services/users/creator.rb:25
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "1@qwe.sjda"], ["id", 26], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:9
Completed 200 OK in 292ms (Views: 0.4ms | ActiveRecord: 15.8ms)


Started POST "/sign_up?referred_by=gkgwaHrQrgPRRR7aHTvScstr" for ::1 at 2021-02-07 18:12:40 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"1@qwe.sjda", "password"=>"[FILTERED]", "referred_by"=>"gkgwaHrQrgPRRR7aHTvScstr", "registration"=>{"email"=>"1@qwe.sjda", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."referral_code" = $1 LIMIT $2[0m  [["referral_code", "gkgwaHrQrgPRRR7aHTvScstr"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:18
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:22
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "1@qwe.sjda"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:22
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/services/users/creator.rb:22
Completed 422 Unprocessable Entity in 277ms (ActiveRecord: 8.2ms)


  
ActiveRecord::RecordInvalid (Validation failed: Email has already been taken):
  
app/services/users/creator.rb:22:in `user'
app/services/users/creator.rb:8:in `create'
app/controllers/registrations_controller.rb:25:in `user'
app/controllers/registrations_controller.rb:6:in `create'
Started POST "/sign_up?referred_by=gkgwaHrQrgPRRR7aHTvScstr" for ::1 at 2021-02-07 18:12:51 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"d1@qwe.sjda", "password"=>"[FILTERED]", "referred_by"=>"gkgwaHrQrgPRRR7aHTvScstr", "registration"=>{"email"=>"d1@qwe.sjda", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."referral_code" = $1 LIMIT $2[0m  [["referral_code", "gkgwaHrQrgPRRR7aHTvScstr"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:18
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:22
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "d1@qwe.sjda"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:22
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at", "referral_code") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["email", "d1@qwe.sjda"], ["password_digest", "$2a$12$EMJCTIuQ2JS3R9Ys3w1pWerI2R2jcuK6YQ2RG1SPLh6SuaHSmQJCC"], ["created_at", "2021-02-07 15:12:52.170301"], ["updated_at", "2021-02-07 15:12:52.170301"], ["referral_code", "VHxREbcXkTrp3S6NTfeJnowN"]]
  â†³ app/services/users/creator.rb:22
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:22
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:8
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "d1@qwe.sjda"], ["id", 27], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:8
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = $1, "referrer_id" = $2 WHERE "users"."id" = $3[0m  [["updated_at", "2021-02-07 15:12:52.174575"], ["referrer_id", 26], ["id", 27]]
  â†³ app/services/users/creator.rb:8
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:8
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "d1@qwe.sjda"], ["id", 27], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:9
  [1m[36mUser Update All (0.7ms)[0m  [1m[33mUPDATE "users" SET "credits" = COALESCE("credits", 0) + 10 WHERE "users"."id" = $1[0m  [["id", 27]]
  â†³ app/services/credits/processor.rb:29
  [1m[36mUser Update All (0.6ms)[0m  [1m[33mUPDATE "users" SET "referral_points" = COALESCE("referral_points", 0) + 1 WHERE "users"."id" = $1[0m  [["id", 26]]
  â†³ app/services/credits/processor.rb:41
Completed 200 OK in 271ms (Views: 0.3ms | ActiveRecord: 4.9ms)


Started POST "/sign_up?referred_by=gkgwaHrQrgPRRR7aHTvScstr" for ::1 at 2021-02-07 18:13:06 +0300
Processing by RegistrationsController#create as */*
  Parameters: {"email"=>"ad1@qwe.sjda", "password"=>"[FILTERED]", "referred_by"=>"gkgwaHrQrgPRRR7aHTvScstr", "registration"=>{"email"=>"ad1@qwe.sjda", "password"=>"[FILTERED]"}}
Unpermitted parameter: :registration
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."referral_code" = $1 LIMIT $2[0m  [["referral_code", "gkgwaHrQrgPRRR7aHTvScstr"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:18
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:22
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "ad1@qwe.sjda"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:22
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at", "referral_code") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["email", "ad1@qwe.sjda"], ["password_digest", "$2a$12$buIjcYBtoB56fYxkFdUOe.jP79WN76xTpOuoh2o90DVT9tnJwGz0W"], ["created_at", "2021-02-07 15:13:06.461260"], ["updated_at", "2021-02-07 15:13:06.461260"], ["referral_code", "22Agdfh9QnvDvVdXTWVnixrm"]]
  â†³ app/services/users/creator.rb:22
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:22
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:8
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "ad1@qwe.sjda"], ["id", 28], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:8
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = $1, "referrer_id" = $2 WHERE "users"."id" = $3[0m  [["updated_at", "2021-02-07 15:13:06.466168"], ["referrer_id", 26], ["id", 28]]
  â†³ app/services/users/creator.rb:8
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:8
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "ad1@qwe.sjda"], ["id", 28], ["LIMIT", 1]]
  â†³ app/controllers/registrations_controller.rb:9
  [1m[36mUser Update All (0.5ms)[0m  [1m[33mUPDATE "users" SET "credits" = COALESCE("credits", 0) + 10 WHERE "users"."id" = $1[0m  [["id", 28]]
  â†³ app/services/credits/processor.rb:29
  [1m[36mUser Update All (0.5ms)[0m  [1m[33mUPDATE "users" SET "referral_points" = COALESCE("referral_points", 0) + 1 WHERE "users"."id" = $1[0m  [["id", 26]]
  â†³ app/services/credits/processor.rb:41
Completed 200 OK in 274ms (Views: 0.3ms | ActiveRecord: 5.4ms)


Started POST "/sign_up?referred_by=gkgwaHrQrgPRRR7aHTvScstr" for ::1 at 2021-02-07 18:31:52 +0300
Processing by UsersController#create as */*
  Parameters: {"email"=>"ad1@qwe.sjda", "password"=>"[FILTERED]", "referred_by"=>"gkgwaHrQrgPRRR7aHTvScstr", "user"=>{"email"=>"ad1@qwe.sjda"}}
Unpermitted parameter: :user
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."referral_code" = $1 LIMIT $2[0m  [["referral_code", "gkgwaHrQrgPRRR7aHTvScstr"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:18
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:22
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "ad1@qwe.sjda"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:22
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/services/users/creator.rb:22
Completed 422 Unprocessable Entity in 273ms (ActiveRecord: 14.3ms)


  
ActiveRecord::RecordInvalid (Validation failed: Email has already been taken):
  
app/services/users/creator.rb:22:in `user'
app/services/users/creator.rb:8:in `create'
app/controllers/users_controller.rb:25:in `user'
app/controllers/users_controller.rb:9:in `create'
Started POST "/sign_in" for ::1 at 2021-02-07 18:32:01 +0300
Processing by SessionsController#create as */*
  Parameters: {"email"=>"ad1@qwe.sjda", "password"=>"[FILTERED]", "session"=>{"email"=>"ad1@qwe.sjda", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "ad1@qwe.sjda"], ["LIMIT", 1]]
  â†³ app/services/authenticate_user.rb:22
Completed 200 OK in 254ms (Views: 0.2ms | ActiveRecord: 0.4ms)


Started POST "/sign_up?referred_by=gkgwaHrQrgPRRR7aHTvScstr" for ::1 at 2021-02-07 18:32:41 +0300
Processing by UsersController#create as */*
  Parameters: {"email"=>"lad1@qwe.sjda", "password"=>"[FILTERED]", "referred_by"=>"gkgwaHrQrgPRRR7aHTvScstr", "user"=>{"email"=>"lad1@qwe.sjda"}}
Unpermitted parameter: :user
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."referral_code" = $1 LIMIT $2[0m  [["referral_code", "gkgwaHrQrgPRRR7aHTvScstr"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:18
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:22
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "lad1@qwe.sjda"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:22
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at", "referral_code") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["email", "lad1@qwe.sjda"], ["password_digest", "$2a$12$pqM.98Klqpn9ADRi6JnPWuvMqkg4.oDp56ODFosFZeDMxnlzTnq0u"], ["created_at", "2021-02-07 15:32:41.555504"], ["updated_at", "2021-02-07 15:32:41.555504"], ["referral_code", "mKCBvMBUhUF2cGqb3WysYmhd"]]
  â†³ app/services/users/creator.rb:22
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:22
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:8
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "lad1@qwe.sjda"], ["id", 29], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:8
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = $1, "referrer_id" = $2 WHERE "users"."id" = $3[0m  [["updated_at", "2021-02-07 15:32:41.560265"], ["referrer_id", 26], ["id", 29]]
  â†³ app/services/users/creator.rb:8
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:8
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "lad1@qwe.sjda"], ["id", 29], ["LIMIT", 1]]
  â†³ app/controllers/users_controller.rb:9
  [1m[36mUser Update All (0.7ms)[0m  [1m[33mUPDATE "users" SET "credits" = COALESCE("credits", 0) + 10 WHERE "users"."id" = $1[0m  [["id", 29]]
  â†³ app/services/credits/processor.rb:29
  [1m[36mUser Update All (0.5ms)[0m  [1m[33mUPDATE "users" SET "referral_points" = COALESCE("referral_points", 0) + 1 WHERE "users"."id" = $1[0m  [["id", 26]]
  â†³ app/services/credits/processor.rb:41
Completed 200 OK in 273ms (Views: 0.4ms | ActiveRecord: 5.1ms)


Started POST "/sign_up?referred_by=gkgwaHrQrgPRRR7aHTvScstr" for ::1 at 2021-02-07 18:33:46 +0300
Processing by UsersController#create as */*
  Parameters: {"email"=>"qlad1@qwe.sjda", "password"=>"[FILTERED]", "referred_by"=>"gkgwaHrQrgPRRR7aHTvScstr", "user"=>{"email"=>"qlad1@qwe.sjda"}}
Unpermitted parameter: :user
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."referral_code" = $1 LIMIT $2[0m  [["referral_code", "gkgwaHrQrgPRRR7aHTvScstr"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:18
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:22
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "qlad1@qwe.sjda"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:22
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at", "referral_code") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["email", "qlad1@qwe.sjda"], ["password_digest", "$2a$12$JfGM54.tdLsXhONQmA4TjObe87.0RXsHDZPul7kAainGd7da6PUtS"], ["created_at", "2021-02-07 15:33:47.011660"], ["updated_at", "2021-02-07 15:33:47.011660"], ["referral_code", "Z9PJBTUMUTeYbMwckif3QBuK"]]
  â†³ app/services/users/creator.rb:22
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:22
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:8
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "qlad1@qwe.sjda"], ["id", 30], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:8
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = $1, "referrer_id" = $2 WHERE "users"."id" = $3[0m  [["updated_at", "2021-02-07 15:33:47.016662"], ["referrer_id", 26], ["id", 30]]
  â†³ app/services/users/creator.rb:8
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:8
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "qlad1@qwe.sjda"], ["id", 30], ["LIMIT", 1]]
  â†³ app/controllers/users_controller.rb:9
  [1m[36mUser Update All (0.6ms)[0m  [1m[33mUPDATE "users" SET "credits" = COALESCE("credits", 0) + 10 WHERE "users"."id" = $1[0m  [["id", 30]]
  â†³ app/services/credits/processor.rb:29
  [1m[36mUser Update All (0.6ms)[0m  [1m[33mUPDATE "users" SET "referral_points" = COALESCE("referral_points", 0) + 1 WHERE "users"."id" = $1[0m  [["id", 26]]
  â†³ app/services/credits/processor.rb:41
Completed 200 OK in 273ms (Views: 0.3ms | ActiveRecord: 13.8ms)


Started POST "/sign_in" for ::1 at 2021-02-07 18:33:52 +0300
Processing by SessionsController#create as */*
  Parameters: {"email"=>"ad1@qwe.sjda", "password"=>"[FILTERED]", "session"=>{"email"=>"ad1@qwe.sjda", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "ad1@qwe.sjda"], ["LIMIT", 1]]
  â†³ app/services/authenticate_user.rb:22
Completed 200 OK in 251ms (Views: 0.1ms | ActiveRecord: 0.4ms)


Started POST "/sign_in" for ::1 at 2021-02-07 18:33:54 +0300
Processing by SessionsController#create as */*
  Parameters: {"email"=>"ad1@qwe.sjda", "password"=>"[FILTERED]", "session"=>{"email"=>"ad1@qwe.sjda", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "ad1@qwe.sjda"], ["LIMIT", 1]]
  â†³ app/services/authenticate_user.rb:22
Completed 200 OK in 260ms (Views: 0.1ms | ActiveRecord: 0.3ms)


Started POST "/sign_in" for ::1 at 2021-02-07 18:33:56 +0300
Processing by SessionsController#create as */*
  Parameters: {"email"=>"ad1@qwe.sjda", "password"=>"[FILTERED]", "session"=>{"email"=>"ad1@qwe.sjda", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "ad1@qwe.sjda"], ["LIMIT", 1]]
  â†³ app/services/authenticate_user.rb:22
Completed 200 OK in 253ms (Views: 0.1ms | ActiveRecord: 0.3ms)


Started POST "/sign_in" for ::1 at 2021-02-07 18:37:32 +0300
Processing by SessionsController#create as */*
  Parameters: {"email"=>"ad1@qwe.sjda", "password"=>"[FILTERED]", "session"=>{"email"=>"ad1@qwe.sjda", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "ad1@qwe.sjda"], ["LIMIT", 1]]
  â†³ app/services/authenticate_user.rb:22
Completed 200 OK in 273ms (Views: 0.2ms | ActiveRecord: 6.6ms)


Started POST "/sign_up?referred_by=gkgwaHrQrgPRRR7aHTvScstr" for ::1 at 2021-02-07 18:37:45 +0300
Processing by UsersController#create as */*
  Parameters: {"email"=>"lqlad1@qwe.sjda", "password"=>"[FILTERED]", "referred_by"=>"gkgwaHrQrgPRRR7aHTvScstr", "user"=>{"email"=>"lqlad1@qwe.sjda"}}
Unpermitted parameter: :user
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."referral_code" = $1 LIMIT $2[0m  [["referral_code", "gkgwaHrQrgPRRR7aHTvScstr"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:18
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:22
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "lqlad1@qwe.sjda"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:22
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at", "referral_code") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["email", "lqlad1@qwe.sjda"], ["password_digest", "$2a$12$dVqsZSyX0rOFtqHpwL7SR.3u/KiF.spvFGKImXNc.7nGB6O7CWZZu"], ["created_at", "2021-02-07 15:37:45.888628"], ["updated_at", "2021-02-07 15:37:45.888628"], ["referral_code", "HtXJdz3rz7Lpa9DY8bXSyQdt"]]
  â†³ app/services/users/creator.rb:22
  [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:22
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:8
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "lqlad1@qwe.sjda"], ["id", 31], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:8
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = $1, "referrer_id" = $2 WHERE "users"."id" = $3[0m  [["updated_at", "2021-02-07 15:37:45.893643"], ["referrer_id", 26], ["id", 31]]
  â†³ app/services/users/creator.rb:8
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:8
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "lqlad1@qwe.sjda"], ["id", 31], ["LIMIT", 1]]
  â†³ app/controllers/users_controller.rb:9
  [1m[36mUser Update All (0.6ms)[0m  [1m[33mUPDATE "users" SET "credits" = COALESCE("credits", 0) + 10 WHERE "users"."id" = $1[0m  [["id", 31]]
  â†³ app/services/credits/processor.rb:29
  [1m[36mUser Update All (0.6ms)[0m  [1m[33mUPDATE "users" SET "referral_points" = COALESCE("referral_points", 0) + 1 WHERE "users"."id" = $1[0m  [["id", 26]]
  â†³ app/services/credits/processor.rb:41
  [1m[36mUser Update All (0.5ms)[0m  [1m[33mUPDATE "users" SET "credits" = COALESCE("credits", 0) + 10 WHERE "users"."id" = $1[0m  [["id", 26]]
  â†³ app/services/credits/processor.rb:48
  [1m[36mUser Update All (0.6ms)[0m  [1m[33mUPDATE "users" SET "referral_points" = COALESCE("referral_points", 0) - 5 WHERE "users"."id" = $1[0m  [["id", 26]]
  â†³ app/services/credits/processor.rb:49
Completed 200 OK in 270ms (Views: 0.4ms | ActiveRecord: 6.3ms)


Started POST "/sign_in" for ::1 at 2021-02-07 18:38:35 +0300
Processing by SessionsController#create as */*
  Parameters: {"email"=>"ad1@qwe.sjda", "password"=>"[FILTERED]", "session"=>{"email"=>"ad1@qwe.sjda", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "ad1@qwe.sjda"], ["LIMIT", 1]]
  â†³ app/services/authenticate_user.rb:22
Completed 200 OK in 252ms (Views: 0.1ms | ActiveRecord: 0.3ms)


Started GET "/users/1" for ::1 at 2021-02-07 18:39:31 +0300
Processing by UsersController#show as */*
  Parameters: {"id"=>"1"}
Completed 500 Internal Server Error in 12ms (ActiveRecord: 0.0ms)


  
NoMethodError (undefined method `headers=' for #<AuthorizeApiRequest:0x00007fbe9a5d31c0>
Did you mean?  headers):
  
app/services/authorize_api_request.rb:3:in `initialize'
app/controllers/application_controller.rb:9:in `new'
app/controllers/application_controller.rb:9:in `authenticate_request'
Started GET "/users/1" for ::1 at 2021-02-07 18:44:03 +0300
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /Users/Alex/.rvm/gems/ruby-2.7.2/gems/activerecord-5.2.4.4/lib/active_record/log_subscriber.rb:98
Processing by UsersController#show as */*
  Parameters: {"id"=>"1"}
Completed 500 Internal Server Error in 2ms (ActiveRecord: 0.0ms)


  
NoMethodError (undefined method `headers=' for #<AuthorizeApiRequest:0x00007fdff6cce7e0>
Did you mean?  headers):
  
app/services/authorize_api_request.rb:3:in `initialize'
app/controllers/application_controller.rb:13:in `new'
app/controllers/application_controller.rb:13:in `current_user'
app/controllers/application_controller.rb:9:in `authenticate_request'
Started GET "/users/1" for ::1 at 2021-02-07 18:45:06 +0300
Processing by UsersController#show as */*
  Parameters: {"id"=>"1"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 28], ["LIMIT", 1]]
  â†³ app/services/authorize_api_request.rb:17
Completed 200 OK in 28ms (Views: 1.0ms | ActiveRecord: 9.8ms)


Started GET "/users/5" for ::1 at 2021-02-07 18:45:12 +0300
Processing by UsersController#show as */*
  Parameters: {"id"=>"5"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 28], ["LIMIT", 1]]
  â†³ app/services/authorize_api_request.rb:17
Completed 200 OK in 2ms (Views: 0.4ms | ActiveRecord: 0.4ms)


Started GET "/users/1" for ::1 at 2021-02-07 18:45:17 +0300
Processing by UsersController#show as */*
  Parameters: {"id"=>"1"}
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 28], ["LIMIT", 1]]
  â†³ app/services/authorize_api_request.rb:17
Completed 200 OK in 4ms (Views: 1.1ms | ActiveRecord: 0.9ms)


Started GET "/users/20" for ::1 at 2021-02-07 18:45:22 +0300
Processing by UsersController#show as */*
  Parameters: {"id"=>"20"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 28], ["LIMIT", 1]]
  â†³ app/services/authorize_api_request.rb:17
Completed 200 OK in 2ms (Views: 0.4ms | ActiveRecord: 0.4ms)


Started GET "/users/20" for ::1 at 2021-02-07 18:45:32 +0300
Processing by UsersController#show as */*
  Parameters: {"id"=>"20"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 28], ["LIMIT", 1]]
  â†³ app/services/authorize_api_request.rb:17
Completed 200 OK in 3ms (Views: 1.0ms | ActiveRecord: 0.6ms)


Started GET "/users/1" for ::1 at 2021-02-07 18:45:40 +0300
Processing by UsersController#show as */*
  Parameters: {"id"=>"1"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 28], ["LIMIT", 1]]
  â†³ app/services/authorize_api_request.rb:17
Completed 200 OK in 2ms (Views: 0.3ms | ActiveRecord: 0.3ms)


Started GET "/users" for ::1 at 2021-02-07 18:45:45 +0300
  
ActionController::RoutingError (No route matches [GET] "/users"):
  
actionpack (5.2.4.4) lib/action_dispatch/middleware/debug_exceptions.rb:65:in `call'
actionpack (5.2.4.4) lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
railties (5.2.4.4) lib/rails/rack/logger.rb:38:in `call_app'
railties (5.2.4.4) lib/rails/rack/logger.rb:26:in `block in call'
activesupport (5.2.4.4) lib/active_support/tagged_logging.rb:71:in `block in tagged'
activesupport (5.2.4.4) lib/active_support/tagged_logging.rb:28:in `tagged'
activesupport (5.2.4.4) lib/active_support/tagged_logging.rb:71:in `tagged'
railties (5.2.4.4) lib/rails/rack/logger.rb:26:in `call'
actionpack (5.2.4.4) lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
actionpack (5.2.4.4) lib/action_dispatch/middleware/request_id.rb:27:in `call'
rack (2.2.3) lib/rack/runtime.rb:22:in `call'
activesupport (5.2.4.4) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (5.2.4.4) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (5.2.4.4) lib/action_dispatch/middleware/static.rb:127:in `call'
rack (2.2.3) lib/rack/sendfile.rb:110:in `call'
railties (5.2.4.4) lib/rails/engine.rb:524:in `call'
puma (3.12.6) lib/puma/configuration.rb:227:in `call'
puma (3.12.6) lib/puma/server.rb:706:in `handle_request'
puma (3.12.6) lib/puma/server.rb:476:in `process_client'
puma (3.12.6) lib/puma/server.rb:334:in `block in run'
puma (3.12.6) lib/puma/thread_pool.rb:135:in `block in spawn_thread'
Started GET "/users" for ::1 at 2021-02-07 18:46:29 +0300
Processing by UsersController#index as */*
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 28], ["LIMIT", 1]]
  â†³ app/services/authorize_api_request.rb:17
Completed 200 OK in 35ms (Views: 0.4ms | ActiveRecord: 7.0ms)


Started POST "/sign_in" for ::1 at 2021-02-07 18:46:45 +0300
Processing by SessionsController#create as */*
  Parameters: {"email"=>"1@qwe.sjda", "password"=>"[FILTERED]", "session"=>{"email"=>"1@qwe.sjda", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "1@qwe.sjda"], ["LIMIT", 1]]
  â†³ app/services/authenticate_user.rb:22
Completed 200 OK in 252ms (Views: 0.1ms | ActiveRecord: 0.4ms)


Started GET "/users" for ::1 at 2021-02-07 18:47:09 +0300
Processing by UsersController#index as */*
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 26], ["LIMIT", 1]]
  â†³ app/services/authorize_api_request.rb:17
Completed 200 OK in 2ms (Views: 0.4ms | ActiveRecord: 0.5ms)


Started GET "/users" for ::1 at 2021-02-07 18:47:17 +0300
Processing by UsersController#index as */*
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 26], ["LIMIT", 1]]
  â†³ app/services/authorize_api_request.rb:17
Completed 200 OK in 1ms (Views: 0.3ms | ActiveRecord: 0.2ms)


Started GET "/users" for ::1 at 2021-02-07 22:04:28 +0300
Processing by UsersController#index as */*
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 26], ["LIMIT", 1]]
  â†³ app/services/authorizer.rb:19
Completed 200 OK in 26ms (Views: 0.4ms | ActiveRecord: 13.5ms)


Started GET "/users" for ::1 at 2021-02-07 22:04:33 +0300
Processing by UsersController#index as */*
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 26], ["LIMIT", 1]]
  â†³ app/services/authorizer.rb:19
Completed 200 OK in 5ms (Views: 1.0ms | ActiveRecord: 1.1ms)


Started GET "/users" for ::1 at 2021-02-07 22:04:38 +0300
Processing by UsersController#index as */*
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 26], ["LIMIT", 1]]
  â†³ app/services/authorizer.rb:19
Completed 200 OK in 2ms (Views: 0.4ms | ActiveRecord: 0.3ms)


Started GET "/users" for ::1 at 2021-02-07 22:04:51 +0300
Processing by UsersController#index as */*
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 26], ["LIMIT", 1]]
  â†³ app/services/authorizer.rb:19
Completed 200 OK in 2ms (Views: 0.4ms | ActiveRecord: 0.4ms)


Started GET "/users" for ::1 at 2021-02-07 22:05:06 +0300
Processing by UsersController#index as */*
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 26], ["LIMIT", 1]]
  â†³ app/services/authorizer.rb:21
Completed 200 OK in 25ms (Views: 0.6ms | ActiveRecord: 6.9ms)


Started GET "/users" for ::1 at 2021-02-07 22:05:17 +0300
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /Users/Alex/.rvm/gems/ruby-2.7.2/gems/activerecord-5.2.4.4/lib/active_record/log_subscriber.rb:98
Processing by UsersController#index as */*
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 26], ["LIMIT", 1]]
  â†³ app/services/authorizer.rb:19
Completed 200 OK in 22ms (Views: 0.6ms | ActiveRecord: 7.2ms)


  [1m[36mUser Load (5.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" ORDER BY "users"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" ORDER BY "users"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "qwe@qwe.fdg"], ["LIMIT", 1]]
  [1m[36mUser Create (3.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at", "referrer_id", "referral_code") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["email", "qwe@qwe.fdg"], ["password_digest", "$2a$12$OlaD6f1CEquiWWeHXHveg.Orsxomp73d5hGpo64jzLnBRwLk.8NZm"], ["created_at", "2021-02-08 19:09:48.809431"], ["updated_at", "2021-02-08 19:09:48.809431"], ["referrer_id", 31], ["referral_code", "J7gGrPCDTaHXqmLJYyKLcB5y"]]
  [1m[35m (0.7ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "qwe@qwe.fdg"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "qwe@qwe.fdgq"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at", "referral_code") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["email", "qwe@qwe.fdgq"], ["password_digest", "$2a$12$icMgjUVQGz.ph840VRV83emdxRow48ej7kvlAU5upyiGz7HUKNNN."], ["created_at", "2021-02-08 19:18:00.840585"], ["updated_at", "2021-02-08 19:18:00.840585"], ["referral_code", "7fq3BYuD9HqxnDUy964RSrjp"]]
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "qqwe@qwe.fdgq"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at", "referral_code") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["email", "qqwe@qwe.fdgq"], ["password_digest", "$2a$12$SRXI/JhK51H.QCqWGKkdQe4zcSwc6l74DONmXAJ/GdKuI2UVVg19y"], ["created_at", "2021-02-08 19:18:10.688876"], ["updated_at", "2021-02-08 19:18:10.688876"], ["referral_code", "iojNJoB8J8Fpq8HKiXVaHz7E"]]
  [1m[35m (0.7ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "qqwe@qwe.fdgq"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "qqwe@qwe.fdgq"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "qqwe@qwe.fdgq"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "qqwe@qwe.fdgq"], ["LIMIT", 1]]
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" ORDER BY "users"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" ORDER BY "users"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" ORDER BY "users"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "qqwe@qwe.fdgq"], ["id", 34], ["LIMIT", 1]]
Started GET "/users" for ::1 at 2021-02-09 00:06:35 +0300
  [1m[35m (3.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /Users/Alex/.rvm/gems/ruby-2.7.2/gems/activerecord-5.2.4.4/lib/active_record/log_subscriber.rb:98
Processing by UsersController#index as */*
Filter chain halted as :authorize_request rendered or redirected
Completed 401 Unauthorized in 1ms (Views: 0.2ms | ActiveRecord: 0.0ms)


Started POST "/sign_in" for ::1 at 2021-02-09 00:06:46 +0300
Processing by SessionsController#create as */*
  Parameters: {"email"=>"1@qwe.sjda", "password"=>"[FILTERED]", "session"=>{"email"=>"1@qwe.sjda", "password"=>"[FILTERED]"}}
Unpermitted parameter: :session
Unpermitted parameter: :session
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "1@qwe.sjda"], ["LIMIT", 1]]
  â†³ app/services/authenticator.rb:25
Completed 200 OK in 283ms (Views: 0.1ms | ActiveRecord: 8.5ms)


Started GET "/users" for ::1 at 2021-02-09 00:07:09 +0300
Processing by UsersController#index as */*
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 26], ["LIMIT", 1]]
  â†³ app/services/authorizer.rb:19
Completed 200 OK in 3ms (Views: 0.2ms | ActiveRecord: 0.5ms)


Started POST "/sign_up?referred_by=gkgwaHrQrgPRRR7aHTvScstr" for ::1 at 2021-02-09 00:10:29 +0300
Processing by UsersController#create as */*
  Parameters: {"email"=>"lqlad1@qwe.sjdaasd", "password"=>"[FILTERED]", "referred_by"=>"gkgwaHrQrgPRRR7aHTvScstr", "user"=>{"email"=>"lqlad1@qwe.sjdaasd"}}
Unpermitted parameter: :user
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:26
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "lqlad1@qwe.sjdaasd"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:26
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at", "referral_code") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["email", "lqlad1@qwe.sjdaasd"], ["password_digest", "$2a$12$R78C.4e32SHbeDlNNGkAduXUxBhZBsz7QjXTribQmcxlrr6QNSfXq"], ["created_at", "2021-02-08 21:10:29.748308"], ["updated_at", "2021-02-08 21:10:29.748308"], ["referral_code", "mnq7JnSfA8kV218Nciou6oxH"]]
  â†³ app/services/users/creator.rb:26
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:26
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "lqlad1@qwe.sjdaasd"], ["id", 35], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."referral_code" = $1 LIMIT $2[0m  [["referral_code", "gkgwaHrQrgPRRR7aHTvScstr"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:22
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:12
  [1m[36mCACHE User Exists (0.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "lqlad1@qwe.sjdaasd"], ["id", 35], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:12
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = $1, "referrer_id" = $2 WHERE "users"."id" = $3[0m  [["updated_at", "2021-02-08 21:10:29.757819"], ["referrer_id", 26], ["id", 35]]
  â†³ app/services/users/creator.rb:12
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:12
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "lqlad1@qwe.sjdaasd"], ["id", 35], ["LIMIT", 1]]
  â†³ app/controllers/users_controller.rb:11
  [1m[36mUser Update All (1.2ms)[0m  [1m[33mUPDATE "users" SET "credits" = COALESCE("credits", 0) + 10 WHERE "users"."id" = $1[0m  [["id", 35]]
  â†³ app/services/credits/processor.rb:31
  [1m[36mUser Update All (0.6ms)[0m  [1m[33mUPDATE "users" SET "referral_points" = COALESCE("referral_points", 0) + 1 WHERE "users"."id" = $1[0m  [["id", 26]]
  â†³ app/services/credits/processor.rb:43
Completed 200 OK in 297ms (Views: 6.7ms | ActiveRecord: 8.2ms)


Started POST "/sign_up" for ::1 at 2021-02-09 11:27:26 +0300
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  â†³ /Users/Alex/.rvm/gems/ruby-2.7.2/gems/activerecord-5.2.4.4/lib/active_record/log_subscriber.rb:98
Processing by UsersController#create as */*
  Parameters: {"email"=>"email@qwe.qwe", "password"=>"[FILTERED]", "user"=>{"email"=>"email@qwe.qwe"}}
Unpermitted parameter: :user
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:26
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "email@qwe.qwe"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:26
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at", "referral_code") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["email", "email@qwe.qwe"], ["password_digest", "$2a$12$xutT7uC3UvZKX1IQrIC/ruK.y84ddYR/fifNhQBwRs0BDMElS/LpG"], ["created_at", "2021-02-09 08:27:26.912897"], ["updated_at", "2021-02-09 08:27:26.912897"], ["referral_code", "1RbPptyhSGKsCcSDzSGzHY2Y"]]
  â†³ app/services/users/creator.rb:26
  [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:26
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "email@qwe.qwe"], ["id", 36], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."referral_code" IS NULL LIMIT $1[0m  [["LIMIT", 1]]
  â†³ app/services/users/creator.rb:22
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:12
  [1m[36mCACHE User Exists (0.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "email@qwe.qwe"], ["id", 36], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:12
  [1m[36mUser Update (0.7ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = $1, "referrer_id" = $2 WHERE "users"."id" = $3[0m  [["updated_at", "2021-02-09 08:27:26.929331"], ["referrer_id", 2], ["id", 36]]
  â†³ app/services/users/creator.rb:12
  [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:12
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "email@qwe.qwe"], ["id", 36], ["LIMIT", 1]]
  â†³ app/controllers/users_controller.rb:11
  [1m[36mUser Update All (0.7ms)[0m  [1m[33mUPDATE "users" SET "credits" = COALESCE("credits", 0) + 10 WHERE "users"."id" = $1[0m  [["id", 36]]
  â†³ app/services/credits/processor.rb:31
  [1m[36mUser Update All (0.7ms)[0m  [1m[33mUPDATE "users" SET "referral_points" = COALESCE("referral_points", 0) + 1 WHERE "users"."id" = $1[0m  [["id", 2]]
  â†³ app/services/credits/processor.rb:43
Completed 201 Created in 320ms (Views: 1.7ms | ActiveRecord: 16.2ms)


Started POST "/sign_up" for ::1 at 2021-02-09 11:28:31 +0300
Processing by UsersController#create as */*
  Parameters: {"email"=>"email@qwe.qwe", "password"=>"[FILTERED]", "user"=>{"email"=>"email@qwe.qwe"}}
Unpermitted parameter: :user
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:26
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "email@qwe.qwe"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:26
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/services/users/creator.rb:26
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "email@qwe.qwe"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:10
  [1m[36mCACHE User Exists (0.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "email@qwe.qwe"], ["LIMIT", 1]]
  â†³ app/controllers/users_controller.rb:11
Completed 400 Bad Request in 281ms (Views: 0.2ms | ActiveRecord: 1.1ms)


Started POST "/sign_up" for ::1 at 2021-02-09 11:28:34 +0300
Processing by UsersController#create as */*
  Parameters: {"email"=>"email1@qwe.qwe", "password"=>"[FILTERED]", "user"=>{"email"=>"email1@qwe.qwe"}}
Unpermitted parameter: :user
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:26
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "email1@qwe.qwe"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:26
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at", "referral_code") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["email", "email1@qwe.qwe"], ["password_digest", "$2a$12$uv1Jnxznv1C9JTlgrp1PNOvox0pnZqCCKxIOKvs.drERultj0UhWa"], ["created_at", "2021-02-09 08:28:34.738784"], ["updated_at", "2021-02-09 08:28:34.738784"], ["referral_code", "f3wBL7QMDCrfTqKsXbtzMiHB"]]
  â†³ app/services/users/creator.rb:26
  [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:26
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "email1@qwe.qwe"], ["id", 37], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."referral_code" IS NULL LIMIT $1[0m  [["LIMIT", 1]]
  â†³ app/services/users/creator.rb:22
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:12
  [1m[36mCACHE User Exists (0.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "email1@qwe.qwe"], ["id", 37], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:12
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = $1, "referrer_id" = $2 WHERE "users"."id" = $3[0m  [["updated_at", "2021-02-09 08:28:34.744584"], ["referrer_id", 3], ["id", 37]]
  â†³ app/services/users/creator.rb:12
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:12
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "email1@qwe.qwe"], ["id", 37], ["LIMIT", 1]]
  â†³ app/controllers/users_controller.rb:11
  [1m[36mUser Update All (0.5ms)[0m  [1m[33mUPDATE "users" SET "credits" = COALESCE("credits", 0) + 10 WHERE "users"."id" = $1[0m  [["id", 37]]
  â†³ app/services/credits/processor.rb:31
  [1m[36mUser Update All (0.8ms)[0m  [1m[33mUPDATE "users" SET "referral_points" = COALESCE("referral_points", 0) + 1 WHERE "users"."id" = $1[0m  [["id", 3]]
  â†³ app/services/credits/processor.rb:43
Completed 201 Created in 275ms (Views: 0.4ms | ActiveRecord: 5.2ms)


Started POST "/sign_up" for ::1 at 2021-02-09 11:28:51 +0300
Processing by UsersController#create as */*
  Parameters: {"email"=>"emaiql1@qwe.qwe", "password"=>"[FILTERED]", "user"=>{"email"=>"emaiql1@qwe.qwe"}}
Unpermitted parameter: :user
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:28
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "emaiql1@qwe.qwe"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:28
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at", "referral_code") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["email", "emaiql1@qwe.qwe"], ["password_digest", "$2a$12$q4Tbkd3qoF0CF6CZLD/M8OsVA0HRMxWlEdEGeAsPGple5BIxclh7u"], ["created_at", "2021-02-09 08:28:51.879232"], ["updated_at", "2021-02-09 08:28:51.879232"], ["referral_code", "63kQe3Jw3v7AVASEjYMr2CMW"]]
  â†³ app/services/users/creator.rb:28
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:28
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "emaiql1@qwe.qwe"], ["id", 38], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."referral_code" IS NULL LIMIT $1[0m  [["LIMIT", 1]]
  â†³ app/services/users/creator.rb:24
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."referral_code" IS NULL LIMIT $1[0m  [["LIMIT", 1]]
  â†³ (byebug):1
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."referral_code" IS NULL LIMIT $1[0m  [["LIMIT", 1]]
  â†³ (byebug):1
  [1m[35m (1.4ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:14
  [1m[36mCACHE User Exists (0.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "emaiql1@qwe.qwe"], ["id", 38], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:14
  [1m[36mUser Update (0.6ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = $1, "referrer_id" = $2 WHERE "users"."id" = $3[0m  [["updated_at", "2021-02-09 08:31:48.364364"], ["referrer_id", 4], ["id", 38]]
  â†³ app/services/users/creator.rb:14
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:14
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "emaiql1@qwe.qwe"], ["id", 38], ["LIMIT", 1]]
  â†³ app/controllers/users_controller.rb:11
  [1m[36mUser Update All (0.6ms)[0m  [1m[33mUPDATE "users" SET "credits" = COALESCE("credits", 0) + 10 WHERE "users"."id" = $1[0m  [["id", 38]]
  â†³ app/services/credits/processor.rb:31
  [1m[36mUser Update All (0.5ms)[0m  [1m[33mUPDATE "users" SET "referral_points" = COALESCE("referral_points", 0) + 1 WHERE "users"."id" = $1[0m  [["id", 4]]
  â†³ app/services/credits/processor.rb:43
Completed 201 Created in 176781ms (Views: 0.4ms | ActiveRecord: 14.4ms)


  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
Started POST "/sign_up" for ::1 at 2021-02-09 11:45:14 +0300
Processing by UsersController#create as */*
  Parameters: {"email"=>"emaiql1@qwe.qwe", "password"=>"[FILTERED]", "user"=>{"email"=>"emaiql1@qwe.qwe"}}
Unpermitted parameter: :user
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:28
  [1m[36mUser Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "emaiql1@qwe.qwe"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:28
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/services/users/creator.rb:28
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "emaiql1@qwe.qwe"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:10
  [1m[36mCACHE User Exists (0.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "emaiql1@qwe.qwe"], ["LIMIT", 1]]
  â†³ app/controllers/users_controller.rb:11
Completed 400 Bad Request in 294ms (Views: 0.2ms | ActiveRecord: 12.2ms)


Started POST "/sign_up" for ::1 at 2021-02-09 11:45:31 +0300
Processing by UsersController#create as */*
  Parameters: {"email"=>"eqmaiql1@qwe.qwe", "password"=>"[FILTERED]", "user"=>{"email"=>"eqmaiql1@qwe.qwe"}}
Unpermitted parameter: :user
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:28
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "eqmaiql1@qwe.qwe"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:28
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at", "referral_code") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["email", "eqmaiql1@qwe.qwe"], ["password_digest", "$2a$12$3xW9Iia6u0Gx8yPbYxrfUuuBuWoIyD6.lFyH.5dP04NnMEMuaXGOi"], ["created_at", "2021-02-09 08:45:31.511158"], ["updated_at", "2021-02-09 08:45:31.511158"], ["referral_code", "8J4UZA3iX2Br82fydzSgiEgA"]]
  â†³ app/services/users/creator.rb:28
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:28
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "eqmaiql1@qwe.qwe"], ["id", 39], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:10
  [1m[36mCACHE User Exists (0.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "eqmaiql1@qwe.qwe"], ["id", 39], ["LIMIT", 1]]
  â†³ app/controllers/users_controller.rb:11
Completed 201 Created in 269ms (Views: 0.3ms | ActiveRecord: 2.8ms)


Started POST "/sign_up" for ::1 at 2021-02-09 11:45:38 +0300
Processing by UsersController#create as */*
  Parameters: {"email"=>"eqmaiql1@qwe.qwe", "password"=>"[FILTERED]", "user"=>{"email"=>"eqmaiql1@qwe.qwe"}}
Unpermitted parameter: :user
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:28
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "eqmaiql1@qwe.qwe"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:28
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/services/users/creator.rb:28
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "eqmaiql1@qwe.qwe"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:10
  [1m[36mCACHE User Exists (0.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "eqmaiql1@qwe.qwe"], ["LIMIT", 1]]
  â†³ app/controllers/users_controller.rb:11
Completed 400 Bad Request in 268ms (Views: 0.1ms | ActiveRecord: 1.1ms)


Started POST "/sign_up" for ::1 at 2021-02-09 11:45:43 +0300
Processing by UsersController#create as */*
  Parameters: {"email"=>"eqmdaiql1@qwe.qwe", "password"=>"[FILTERED]", "user"=>{"email"=>"eqmdaiql1@qwe.qwe"}}
Unpermitted parameter: :user
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:28
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "eqmdaiql1@qwe.qwe"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:28
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at", "referral_code") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["email", "eqmdaiql1@qwe.qwe"], ["password_digest", "$2a$12$dFN0o/CtNppIML10gYou8.VYAhpFmJHXhpdAigo/nHS963Zk3zeM6"], ["created_at", "2021-02-09 08:45:43.313392"], ["updated_at", "2021-02-09 08:45:43.313392"], ["referral_code", "Y8rCAPArTqQe88MfyxsSBp1K"]]
  â†³ app/services/users/creator.rb:28
  [1m[35m (0.7ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:28
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "eqmdaiql1@qwe.qwe"], ["id", 40], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:10
  [1m[36mCACHE User Exists (0.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "eqmdaiql1@qwe.qwe"], ["id", 40], ["LIMIT", 1]]
  â†³ app/controllers/users_controller.rb:11
Completed 201 Created in 267ms (Views: 0.3ms | ActiveRecord: 2.3ms)


Started POST "/sign_in" for ::1 at 2021-02-09 11:46:00 +0300
Processing by SessionsController#create as */*
  Parameters: {"email"=>"eqmdaiql1@qwe.qwe", "password"=>"[FILTERED]", "session"=>{"email"=>"eqmdaiql1@qwe.qwe", "password"=>"[FILTERED]"}}
Unpermitted parameter: :session
Unpermitted parameter: :session
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "eqmdaiql1@qwe.qwe"], ["LIMIT", 1]]
  â†³ app/services/authenticator.rb:25
Completed 200 OK in 264ms (Views: 0.1ms | ActiveRecord: 0.6ms)


Started GET "/users" for ::1 at 2021-02-09 11:46:25 +0300
Processing by UsersController#index as */*
  Parameters: {"user"=>{}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 40], ["LIMIT", 1]]
  â†³ app/services/authorizer.rb:19
Completed 200 OK in 3ms (Views: 0.1ms | ActiveRecord: 0.5ms)


Started GET "/sign_up?referred_by=Y8rCAPArTqQe88MfyxsSBp1K" for ::1 at 2021-02-09 11:47:10 +0300
  
ActionController::RoutingError (No route matches [GET] "/sign_up"):
  
actionpack (5.2.4.4) lib/action_dispatch/middleware/debug_exceptions.rb:65:in `call'
actionpack (5.2.4.4) lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
railties (5.2.4.4) lib/rails/rack/logger.rb:38:in `call_app'
railties (5.2.4.4) lib/rails/rack/logger.rb:26:in `block in call'
activesupport (5.2.4.4) lib/active_support/tagged_logging.rb:71:in `block in tagged'
activesupport (5.2.4.4) lib/active_support/tagged_logging.rb:28:in `tagged'
activesupport (5.2.4.4) lib/active_support/tagged_logging.rb:71:in `tagged'
railties (5.2.4.4) lib/rails/rack/logger.rb:26:in `call'
actionpack (5.2.4.4) lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
actionpack (5.2.4.4) lib/action_dispatch/middleware/request_id.rb:27:in `call'
rack (2.2.3) lib/rack/runtime.rb:22:in `call'
activesupport (5.2.4.4) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (5.2.4.4) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (5.2.4.4) lib/action_dispatch/middleware/static.rb:127:in `call'
rack (2.2.3) lib/rack/sendfile.rb:110:in `call'
railties (5.2.4.4) lib/rails/engine.rb:524:in `call'
puma (3.12.6) lib/puma/configuration.rb:227:in `call'
puma (3.12.6) lib/puma/server.rb:706:in `handle_request'
puma (3.12.6) lib/puma/server.rb:476:in `process_client'
puma (3.12.6) lib/puma/server.rb:334:in `block in run'
puma (3.12.6) lib/puma/thread_pool.rb:135:in `block in spawn_thread'
Started GET "/sign_up?referred_by=Y8rCAPArTqQe88MfyxsSBp1K" for ::1 at 2021-02-09 11:47:48 +0300
  
ActionController::RoutingError (No route matches [GET] "/sign_up"):
  
actionpack (5.2.4.4) lib/action_dispatch/middleware/debug_exceptions.rb:65:in `call'
actionpack (5.2.4.4) lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
railties (5.2.4.4) lib/rails/rack/logger.rb:38:in `call_app'
railties (5.2.4.4) lib/rails/rack/logger.rb:26:in `block in call'
activesupport (5.2.4.4) lib/active_support/tagged_logging.rb:71:in `block in tagged'
activesupport (5.2.4.4) lib/active_support/tagged_logging.rb:28:in `tagged'
activesupport (5.2.4.4) lib/active_support/tagged_logging.rb:71:in `tagged'
railties (5.2.4.4) lib/rails/rack/logger.rb:26:in `call'
actionpack (5.2.4.4) lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
actionpack (5.2.4.4) lib/action_dispatch/middleware/request_id.rb:27:in `call'
rack (2.2.3) lib/rack/runtime.rb:22:in `call'
activesupport (5.2.4.4) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (5.2.4.4) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (5.2.4.4) lib/action_dispatch/middleware/static.rb:127:in `call'
rack (2.2.3) lib/rack/sendfile.rb:110:in `call'
railties (5.2.4.4) lib/rails/engine.rb:524:in `call'
puma (3.12.6) lib/puma/configuration.rb:227:in `call'
puma (3.12.6) lib/puma/server.rb:706:in `handle_request'
puma (3.12.6) lib/puma/server.rb:476:in `process_client'
puma (3.12.6) lib/puma/server.rb:334:in `block in run'
puma (3.12.6) lib/puma/thread_pool.rb:135:in `block in spawn_thread'
Started POST "/sign_up?referred_by=Y8rCAPArTqQe88MfyxsSBp1K" for ::1 at 2021-02-09 11:48:33 +0300
Processing by UsersController#create as */*
  Parameters: {"email"=>"1@asd.zxc", "password"=>"[FILTERED]", "referred_by"=>"Y8rCAPArTqQe88MfyxsSBp1K", "user"=>{"email"=>"1@asd.zxc"}}
Unpermitted parameter: :user
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:28
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "1@asd.zxc"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:28
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at", "referral_code") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["email", "1@asd.zxc"], ["password_digest", "$2a$12$ghNuI8TO.u0Czh0HbNaqfOKYUyiFPtS7Io.fsGq7odlPURBBQChiS"], ["created_at", "2021-02-09 08:48:34.017114"], ["updated_at", "2021-02-09 08:48:34.017114"], ["referral_code", "CRYe2QrwrvyjyRW1oAs58D9z"]]
  â†³ app/services/users/creator.rb:28
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:28
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "1@asd.zxc"], ["id", 41], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."referral_code" = $1 LIMIT $2[0m  [["referral_code", "Y8rCAPArTqQe88MfyxsSBp1K"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:24
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:12
  [1m[36mCACHE User Exists (0.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "1@asd.zxc"], ["id", 41], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:12
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = $1, "referrer_id" = $2 WHERE "users"."id" = $3[0m  [["updated_at", "2021-02-09 08:48:34.023515"], ["referrer_id", 40], ["id", 41]]
  â†³ app/services/users/creator.rb:12
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:12
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "1@asd.zxc"], ["id", 41], ["LIMIT", 1]]
  â†³ app/controllers/users_controller.rb:11
  [1m[36mUser Update All (0.7ms)[0m  [1m[33mUPDATE "users" SET "credits" = COALESCE("credits", 0) + 10 WHERE "users"."id" = $1[0m  [["id", 41]]
  â†³ app/services/credits/processor.rb:31
  [1m[36mUser Update All (0.7ms)[0m  [1m[33mUPDATE "users" SET "referral_points" = COALESCE("referral_points", 0) + 1 WHERE "users"."id" = $1[0m  [["id", 40]]
  â†³ app/services/credits/processor.rb:43
Completed 201 Created in 276ms (Views: 0.4ms | ActiveRecord: 5.6ms)


Started POST "/sign_up?referred_by=Y8rCAPArTqQe88MfyxsSBp1K" for ::1 at 2021-02-09 11:48:41 +0300
Processing by UsersController#create as */*
  Parameters: {"email"=>"12@asd.zxc", "password"=>"[FILTERED]", "referred_by"=>"Y8rCAPArTqQe88MfyxsSBp1K", "user"=>{"email"=>"12@asd.zxc"}}
Unpermitted parameter: :user
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:28
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "12@asd.zxc"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:28
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at", "referral_code") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["email", "12@asd.zxc"], ["password_digest", "$2a$12$ocn/tWBdAXbDPSX3h.iYrezcH2o1kEMahnzkfmwZqXJxWaaZsYOkS"], ["created_at", "2021-02-09 08:48:41.871530"], ["updated_at", "2021-02-09 08:48:41.871530"], ["referral_code", "ngQTjxtaik73bvkNVn8b3gwX"]]
  â†³ app/services/users/creator.rb:28
  [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:28
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "12@asd.zxc"], ["id", 42], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."referral_code" = $1 LIMIT $2[0m  [["referral_code", "Y8rCAPArTqQe88MfyxsSBp1K"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:24
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:12
  [1m[36mCACHE User Exists (0.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "12@asd.zxc"], ["id", 42], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:12
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = $1, "referrer_id" = $2 WHERE "users"."id" = $3[0m  [["updated_at", "2021-02-09 08:48:41.876980"], ["referrer_id", 40], ["id", 42]]
  â†³ app/services/users/creator.rb:12
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:12
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "12@asd.zxc"], ["id", 42], ["LIMIT", 1]]
  â†³ app/controllers/users_controller.rb:11
  [1m[36mUser Update All (0.5ms)[0m  [1m[33mUPDATE "users" SET "credits" = COALESCE("credits", 0) + 10 WHERE "users"."id" = $1[0m  [["id", 42]]
  â†³ app/services/credits/processor.rb:31
  [1m[36mUser Update All (0.5ms)[0m  [1m[33mUPDATE "users" SET "referral_points" = COALESCE("referral_points", 0) + 1 WHERE "users"."id" = $1[0m  [["id", 40]]
  â†³ app/services/credits/processor.rb:43
Completed 201 Created in 280ms (Views: 0.3ms | ActiveRecord: 4.8ms)


Started POST "/sign_up?referred_by=Y8rCAPArTqQe88MfyxsSBp1K" for ::1 at 2021-02-09 11:48:44 +0300
Processing by UsersController#create as */*
  Parameters: {"email"=>"123@asd.zxc", "password"=>"[FILTERED]", "referred_by"=>"Y8rCAPArTqQe88MfyxsSBp1K", "user"=>{"email"=>"123@asd.zxc"}}
Unpermitted parameter: :user
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:28
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "123@asd.zxc"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:28
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at", "referral_code") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["email", "123@asd.zxc"], ["password_digest", "$2a$12$NkfEcwW/Npms6fOxHJfuu.BBsm99QMzm/FOdm8JTDqF6uklLyI8fS"], ["created_at", "2021-02-09 08:48:44.283190"], ["updated_at", "2021-02-09 08:48:44.283190"], ["referral_code", "v76DfuWsScy1EBEz5pxtZk1Q"]]
  â†³ app/services/users/creator.rb:28
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:28
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "123@asd.zxc"], ["id", 43], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."referral_code" = $1 LIMIT $2[0m  [["referral_code", "Y8rCAPArTqQe88MfyxsSBp1K"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:24
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:12
  [1m[36mCACHE User Exists (0.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "123@asd.zxc"], ["id", 43], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:12
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = $1, "referrer_id" = $2 WHERE "users"."id" = $3[0m  [["updated_at", "2021-02-09 08:48:44.289094"], ["referrer_id", 40], ["id", 43]]
  â†³ app/services/users/creator.rb:12
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:12
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "123@asd.zxc"], ["id", 43], ["LIMIT", 1]]
  â†³ app/controllers/users_controller.rb:11
  [1m[36mUser Update All (0.5ms)[0m  [1m[33mUPDATE "users" SET "credits" = COALESCE("credits", 0) + 10 WHERE "users"."id" = $1[0m  [["id", 43]]
  â†³ app/services/credits/processor.rb:31
  [1m[36mUser Update All (0.6ms)[0m  [1m[33mUPDATE "users" SET "referral_points" = COALESCE("referral_points", 0) + 1 WHERE "users"."id" = $1[0m  [["id", 40]]
  â†³ app/services/credits/processor.rb:43
Completed 201 Created in 274ms (Views: 0.3ms | ActiveRecord: 5.0ms)


Started POST "/sign_up?referred_by=Y8rCAPArTqQe88MfyxsSBp1K" for ::1 at 2021-02-09 11:48:46 +0300
Processing by UsersController#create as */*
  Parameters: {"email"=>"1234@asd.zxc", "password"=>"[FILTERED]", "referred_by"=>"Y8rCAPArTqQe88MfyxsSBp1K", "user"=>{"email"=>"1234@asd.zxc"}}
Unpermitted parameter: :user
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:28
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "1234@asd.zxc"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:28
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at", "referral_code") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["email", "1234@asd.zxc"], ["password_digest", "$2a$12$oMB7MRT1N5Xt2DISlN.tp.atjq2k9AUkveZJH3aAGou29m9MhHpQG"], ["created_at", "2021-02-09 08:48:47.173904"], ["updated_at", "2021-02-09 08:48:47.173904"], ["referral_code", "56fCKnqf7xA1fYKZ5hQFLbhs"]]
  â†³ app/services/users/creator.rb:28
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:28
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "1234@asd.zxc"], ["id", 44], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."referral_code" = $1 LIMIT $2[0m  [["referral_code", "Y8rCAPArTqQe88MfyxsSBp1K"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:24
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:12
  [1m[36mCACHE User Exists (0.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "1234@asd.zxc"], ["id", 44], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:12
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = $1, "referrer_id" = $2 WHERE "users"."id" = $3[0m  [["updated_at", "2021-02-09 08:48:47.178767"], ["referrer_id", 40], ["id", 44]]
  â†³ app/services/users/creator.rb:12
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:12
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "1234@asd.zxc"], ["id", 44], ["LIMIT", 1]]
  â†³ app/controllers/users_controller.rb:11
  [1m[36mUser Update All (0.6ms)[0m  [1m[33mUPDATE "users" SET "credits" = COALESCE("credits", 0) + 10 WHERE "users"."id" = $1[0m  [["id", 44]]
  â†³ app/services/credits/processor.rb:31
  [1m[36mUser Update All (0.6ms)[0m  [1m[33mUPDATE "users" SET "referral_points" = COALESCE("referral_points", 0) + 1 WHERE "users"."id" = $1[0m  [["id", 40]]
  â†³ app/services/credits/processor.rb:43
Completed 201 Created in 281ms (Views: 0.3ms | ActiveRecord: 4.4ms)


Started POST "/sign_up?referred_by=Y8rCAPArTqQe88MfyxsSBp1K" for ::1 at 2021-02-09 11:48:50 +0300
Processing by UsersController#create as */*
  Parameters: {"email"=>"12345@asd.zxc", "password"=>"[FILTERED]", "referred_by"=>"Y8rCAPArTqQe88MfyxsSBp1K", "user"=>{"email"=>"12345@asd.zxc"}}
Unpermitted parameter: :user
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:28
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "12345@asd.zxc"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:28
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at", "referral_code") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["email", "12345@asd.zxc"], ["password_digest", "$2a$12$BK5NbZI6ZLc5WjHCySt3.ODIPSO2uwshvrtt4FAdefEFcFH3HssoO"], ["created_at", "2021-02-09 08:48:50.921038"], ["updated_at", "2021-02-09 08:48:50.921038"], ["referral_code", "Wmpit6nkFEBeMTCJac4kdPpv"]]
  â†³ app/services/users/creator.rb:28
  [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:28
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "12345@asd.zxc"], ["id", 45], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."referral_code" = $1 LIMIT $2[0m  [["referral_code", "Y8rCAPArTqQe88MfyxsSBp1K"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:24
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:12
  [1m[36mCACHE User Exists (0.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "12345@asd.zxc"], ["id", 45], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:12
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = $1, "referrer_id" = $2 WHERE "users"."id" = $3[0m  [["updated_at", "2021-02-09 08:48:50.926888"], ["referrer_id", 40], ["id", 45]]
  â†³ app/services/users/creator.rb:12
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:12
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "12345@asd.zxc"], ["id", 45], ["LIMIT", 1]]
  â†³ app/controllers/users_controller.rb:11
  [1m[36mUser Update All (0.5ms)[0m  [1m[33mUPDATE "users" SET "credits" = COALESCE("credits", 0) + 10 WHERE "users"."id" = $1[0m  [["id", 45]]
  â†³ app/services/credits/processor.rb:31
  [1m[36mUser Update All (0.5ms)[0m  [1m[33mUPDATE "users" SET "referral_points" = COALESCE("referral_points", 0) + 1 WHERE "users"."id" = $1[0m  [["id", 40]]
  â†³ app/services/credits/processor.rb:43
  [1m[36mUser Update All (0.6ms)[0m  [1m[33mUPDATE "users" SET "credits" = COALESCE("credits", 0) + 10 WHERE "users"."id" = $1[0m  [["id", 40]]
  â†³ app/services/credits/processor.rb:50
  [1m[36mUser Update All (0.6ms)[0m  [1m[33mUPDATE "users" SET "referral_points" = COALESCE("referral_points", 0) - 5 WHERE "users"."id" = $1[0m  [["id", 40]]
  â†³ app/services/credits/processor.rb:51
Completed 201 Created in 283ms (Views: 0.3ms | ActiveRecord: 6.1ms)


Started POST "/sign_up?referred_by=Y8rCAPArTqQe88MfyxsSBp1K" for ::1 at 2021-02-09 11:48:54 +0300
Processing by UsersController#create as */*
  Parameters: {"email"=>"123456@asd.zxc", "password"=>"[FILTERED]", "referred_by"=>"Y8rCAPArTqQe88MfyxsSBp1K", "user"=>{"email"=>"123456@asd.zxc"}}
Unpermitted parameter: :user
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:28
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "123456@asd.zxc"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:28
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at", "referral_code") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["email", "123456@asd.zxc"], ["password_digest", "$2a$12$KlBW2OPjZmOtSpy4On9q0OACDOGFNR.LGE7qBblns02DkqaIrObGG"], ["created_at", "2021-02-09 08:48:54.660251"], ["updated_at", "2021-02-09 08:48:54.660251"], ["referral_code", "2a5AHdvdpJ598suMYGWkqf4g"]]
  â†³ app/services/users/creator.rb:28
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:28
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "123456@asd.zxc"], ["id", 46], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."referral_code" = $1 LIMIT $2[0m  [["referral_code", "Y8rCAPArTqQe88MfyxsSBp1K"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:24
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:12
  [1m[36mCACHE User Exists (0.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "123456@asd.zxc"], ["id", 46], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:12
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = $1, "referrer_id" = $2 WHERE "users"."id" = $3[0m  [["updated_at", "2021-02-09 08:48:54.665770"], ["referrer_id", 40], ["id", 46]]
  â†³ app/services/users/creator.rb:12
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:12
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "123456@asd.zxc"], ["id", 46], ["LIMIT", 1]]
  â†³ app/controllers/users_controller.rb:11
  [1m[36mUser Update All (0.6ms)[0m  [1m[33mUPDATE "users" SET "credits" = COALESCE("credits", 0) + 10 WHERE "users"."id" = $1[0m  [["id", 46]]
  â†³ app/services/credits/processor.rb:31
  [1m[36mUser Update All (0.6ms)[0m  [1m[33mUPDATE "users" SET "referral_points" = COALESCE("referral_points", 0) + 1 WHERE "users"."id" = $1[0m  [["id", 40]]
  â†³ app/services/credits/processor.rb:43
Completed 201 Created in 275ms (Views: 0.3ms | ActiveRecord: 4.8ms)


Started GET "/users" for ::1 at 2021-02-09 11:48:57 +0300
Processing by UsersController#index as */*
  Parameters: {"user"=>{}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 40], ["LIMIT", 1]]
  â†³ app/services/authorizer.rb:19
Completed 200 OK in 2ms (Views: 0.1ms | ActiveRecord: 0.4ms)


Started GET "/users" for ::1 at 2021-02-09 11:49:44 +0300
Processing by UsersController#index as */*
  Parameters: {"user"=>{}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 40], ["LIMIT", 1]]
  â†³ app/services/authorizer.rb:19
Completed 200 OK in 18ms (Views: 0.3ms | ActiveRecord: 6.4ms)


Started POST "/sign_up?referred_by=Y8rCAPArTqQe88MfyxsSBp1K" for ::1 at 2021-02-09 11:49:49 +0300
Processing by UsersController#create as */*
  Parameters: {"email"=>"123456@asd.zxc", "password"=>"[FILTERED]", "referred_by"=>"Y8rCAPArTqQe88MfyxsSBp1K", "user"=>{"email"=>"123456@asd.zxc"}}
Unpermitted parameter: :user
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:28
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "123456@asd.zxc"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:28
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/services/users/creator.rb:28
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "123456@asd.zxc"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:10
  [1m[36mCACHE User Exists (0.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "123456@asd.zxc"], ["LIMIT", 1]]
  â†³ app/controllers/users_controller.rb:11
Completed 400 Bad Request in 276ms (Views: 0.2ms | ActiveRecord: 1.0ms)


Started POST "/sign_up?referred_by=Y8rCAPArTqQe88MfyxsSBp1K" for ::1 at 2021-02-09 11:49:51 +0300
Processing by UsersController#create as */*
  Parameters: {"email"=>"1234565@asd.zxc", "password"=>"[FILTERED]", "referred_by"=>"Y8rCAPArTqQe88MfyxsSBp1K", "user"=>{"email"=>"1234565@asd.zxc"}}
Unpermitted parameter: :user
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:28
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "1234565@asd.zxc"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:28
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at", "referral_code") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["email", "1234565@asd.zxc"], ["password_digest", "$2a$12$z3eWFpYdIFeTiE6h6Ma7LugJ434jkiejXXW9zEo/9ORO5Q6f8UpE."], ["created_at", "2021-02-09 08:49:52.061833"], ["updated_at", "2021-02-09 08:49:52.061833"], ["referral_code", "Kjy4uu2VLbKveWQbo21EniCi"]]
  â†³ app/services/users/creator.rb:28
  [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:28
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "1234565@asd.zxc"], ["id", 47], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."referral_code" = $1 LIMIT $2[0m  [["referral_code", "Y8rCAPArTqQe88MfyxsSBp1K"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:24
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:12
  [1m[36mCACHE User Exists (0.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "1234565@asd.zxc"], ["id", 47], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:12
  [1m[36mUser Update (1.1ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = $1, "referrer_id" = $2 WHERE "users"."id" = $3[0m  [["updated_at", "2021-02-09 08:49:52.068654"], ["referrer_id", 40], ["id", 47]]
  â†³ app/services/users/creator.rb:12
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:12
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "1234565@asd.zxc"], ["id", 47], ["LIMIT", 1]]
  â†³ app/controllers/users_controller.rb:11
  [1m[36mUser Update All (0.6ms)[0m  [1m[33mUPDATE "users" SET "credits" = COALESCE("credits", 0) + 10 WHERE "users"."id" = $1[0m  [["id", 47]]
  â†³ app/services/credits/processor.rb:31
  [1m[36mUser Update All (0.6ms)[0m  [1m[33mUPDATE "users" SET "referral_points" = COALESCE("referral_points", 0) + 1 WHERE "users"."id" = $1[0m  [["id", 40]]
  â†³ app/services/credits/processor.rb:43
Completed 201 Created in 284ms (Views: 0.4ms | ActiveRecord: 5.8ms)


Started POST "/sign_up?referred_by=Y8rCAPArTqQe88MfyxsSBp1K" for ::1 at 2021-02-09 11:49:53 +0300
Processing by UsersController#create as */*
  Parameters: {"email"=>"12343565@asd.zxc", "password"=>"[FILTERED]", "referred_by"=>"Y8rCAPArTqQe88MfyxsSBp1K", "user"=>{"email"=>"12343565@asd.zxc"}}
Unpermitted parameter: :user
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:28
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "12343565@asd.zxc"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:28
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at", "referral_code") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["email", "12343565@asd.zxc"], ["password_digest", "$2a$12$G9FVrB8CeLrm18E/Rf/z/.FWA6ybtKQT69B4nvQigqZZo3F9WWCX2"], ["created_at", "2021-02-09 08:49:53.896085"], ["updated_at", "2021-02-09 08:49:53.896085"], ["referral_code", "e3687WAim4WdSPCkptP1S1Qt"]]
  â†³ app/services/users/creator.rb:28
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:28
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "12343565@asd.zxc"], ["id", 48], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."referral_code" = $1 LIMIT $2[0m  [["referral_code", "Y8rCAPArTqQe88MfyxsSBp1K"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:24
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:12
  [1m[36mCACHE User Exists (0.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "12343565@asd.zxc"], ["id", 48], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:12
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = $1, "referrer_id" = $2 WHERE "users"."id" = $3[0m  [["updated_at", "2021-02-09 08:49:53.906316"], ["referrer_id", 40], ["id", 48]]
  â†³ app/services/users/creator.rb:12
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:12
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "12343565@asd.zxc"], ["id", 48], ["LIMIT", 1]]
  â†³ app/controllers/users_controller.rb:11
  [1m[36mUser Update All (0.6ms)[0m  [1m[33mUPDATE "users" SET "credits" = COALESCE("credits", 0) + 10 WHERE "users"."id" = $1[0m  [["id", 48]]
  â†³ app/services/credits/processor.rb:31
  [1m[36mUser Update All (0.6ms)[0m  [1m[33mUPDATE "users" SET "referral_points" = COALESCE("referral_points", 0) + 1 WHERE "users"."id" = $1[0m  [["id", 40]]
  â†³ app/services/credits/processor.rb:43
Completed 201 Created in 289ms (Views: 0.3ms | ActiveRecord: 4.9ms)


Started POST "/sign_up?referred_by=Y8rCAPArTqQe88MfyxsSBp1K" for ::1 at 2021-02-09 11:49:55 +0300
Processing by UsersController#create as */*
  Parameters: {"email"=>"123435465@asd.zxc", "password"=>"[FILTERED]", "referred_by"=>"Y8rCAPArTqQe88MfyxsSBp1K", "user"=>{"email"=>"123435465@asd.zxc"}}
Unpermitted parameter: :user
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:28
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "123435465@asd.zxc"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:28
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at", "referral_code") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["email", "123435465@asd.zxc"], ["password_digest", "$2a$12$pBgOtK/sz2yU6ybF8ROH6e2yu2ud/2jCbrO3kQoEnqqSDpOR3sZ8m"], ["created_at", "2021-02-09 08:49:55.792958"], ["updated_at", "2021-02-09 08:49:55.792958"], ["referral_code", "GouA6rAHbzPWfwdD7j4bf3Kb"]]
  â†³ app/services/users/creator.rb:28
  [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:28
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "123435465@asd.zxc"], ["id", 49], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."referral_code" = $1 LIMIT $2[0m  [["referral_code", "Y8rCAPArTqQe88MfyxsSBp1K"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:24
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:12
  [1m[36mCACHE User Exists (0.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "123435465@asd.zxc"], ["id", 49], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:12
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = $1, "referrer_id" = $2 WHERE "users"."id" = $3[0m  [["updated_at", "2021-02-09 08:49:55.798415"], ["referrer_id", 40], ["id", 49]]
  â†³ app/services/users/creator.rb:12
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:12
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "123435465@asd.zxc"], ["id", 49], ["LIMIT", 1]]
  â†³ app/controllers/users_controller.rb:11
  [1m[36mUser Update All (0.6ms)[0m  [1m[33mUPDATE "users" SET "credits" = COALESCE("credits", 0) + 10 WHERE "users"."id" = $1[0m  [["id", 49]]
  â†³ app/services/credits/processor.rb:31
  [1m[36mUser Update All (0.6ms)[0m  [1m[33mUPDATE "users" SET "referral_points" = COALESCE("referral_points", 0) + 1 WHERE "users"."id" = $1[0m  [["id", 40]]
  â†³ app/services/credits/processor.rb:43
Completed 201 Created in 281ms (Views: 0.3ms | ActiveRecord: 4.7ms)


Started POST "/sign_up?referred_by=Y8rCAPArTqQe88MfyxsSBp1K" for ::1 at 2021-02-09 11:49:57 +0300
Processing by UsersController#create as */*
  Parameters: {"email"=>"1234235465@asd.zxc", "password"=>"[FILTERED]", "referred_by"=>"Y8rCAPArTqQe88MfyxsSBp1K", "user"=>{"email"=>"1234235465@asd.zxc"}}
Unpermitted parameter: :user
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:28
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "1234235465@asd.zxc"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:28
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("email", "password_digest", "created_at", "updated_at", "referral_code") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["email", "1234235465@asd.zxc"], ["password_digest", "$2a$12$hBUfz4TvVOCfMWeklBN9E..rbDBnUEaQnANm.CzVmXXf5dbS9bmAK"], ["created_at", "2021-02-09 08:49:57.502990"], ["updated_at", "2021-02-09 08:49:57.502990"], ["referral_code", "E66hDxc43riFL9tofZuw43ES"]]
  â†³ app/services/users/creator.rb:28
  [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:28
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "1234235465@asd.zxc"], ["id", 50], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:10
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."referral_code" = $1 LIMIT $2[0m  [["referral_code", "Y8rCAPArTqQe88MfyxsSBp1K"], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:24
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  â†³ app/services/users/creator.rb:12
  [1m[36mCACHE User Exists (0.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "1234235465@asd.zxc"], ["id", 50], ["LIMIT", 1]]
  â†³ app/services/users/creator.rb:12
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = $1, "referrer_id" = $2 WHERE "users"."id" = $3[0m  [["updated_at", "2021-02-09 08:49:57.508795"], ["referrer_id", 40], ["id", 50]]
  â†³ app/services/users/creator.rb:12
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/services/users/creator.rb:12
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "1234235465@asd.zxc"], ["id", 50], ["LIMIT", 1]]
  â†³ app/controllers/users_controller.rb:11
  [1m[36mUser Update All (0.6ms)[0m  [1m[33mUPDATE "users" SET "credits" = COALESCE("credits", 0) + 10 WHERE "users"."id" = $1[0m  [["id", 50]]
  â†³ app/services/credits/processor.rb:31
  [1m[36mUser Update All (0.5ms)[0m  [1m[33mUPDATE "users" SET "referral_points" = COALESCE("referral_points", 0) + 1 WHERE "users"."id" = $1[0m  [["id", 40]]
  â†³ app/services/credits/processor.rb:43
  [1m[36mUser Update All (0.6ms)[0m  [1m[33mUPDATE "users" SET "credits" = COALESCE("credits", 0) + 10 WHERE "users"."id" = $1[0m  [["id", 40]]
  â†³ app/services/credits/processor.rb:50
  [1m[36mUser Update All (0.5ms)[0m  [1m[33mUPDATE "users" SET "referral_points" = COALESCE("referral_points", 0) - 5 WHERE "users"."id" = $1[0m  [["id", 40]]
  â†³ app/services/credits/processor.rb:51
Completed 201 Created in 275ms (Views: 0.3ms | ActiveRecord: 6.1ms)


Started GET "/users" for ::1 at 2021-02-09 11:50:02 +0300
Processing by UsersController#index as */*
  Parameters: {"user"=>{}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 40], ["LIMIT", 1]]
  â†³ app/services/authorizer.rb:19
Completed 200 OK in 2ms (Views: 0.1ms | ActiveRecord: 0.4ms)


  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" ORDER BY "users"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 40], ["LIMIT", 1]]
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 41], ["LIMIT", 1]]
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 39], ["LIMIT", 1]]
